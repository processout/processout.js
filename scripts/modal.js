!function(){function t(t){this.message=t}var r="undefined"!=typeof exports?exports:self,e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";(t.prototype=new Error).name="InvalidCharacterError",r.btoa||(r.btoa=function(r){for(var o,n,a=String(r),i=0,c=e,d="";a.charAt(0|i)||(c="=",i%1);d+=c.charAt(63&o>>8-i%1*8)){if(255<(n=a.charCodeAt(i+=.75)))throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");o=o<<8|n}return d}),r.atob||(r.atob=function(r){var o=String(r).replace(/=+$/,"");if(o.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,a,i=0,c=0,d="";a=o.charAt(c++);~a&&(n=i%4?64*n+a:a,i++%4)&&(d+=String.fromCharCode(255&n>>(-2*i&6))))a=e.indexOf(a);return d})}(),"function"!=typeof Object.assign&&(Object.assign=function(a,b){"use strict";if(null==a)throw new TypeError("Cannot convert undefined or null to object");for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var f in e)Object.prototype.hasOwnProperty.call(e,f)&&(c[f]=e[f])}return c}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(item){item.hasOwnProperty("remove")||Object.defineProperty(item,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function remove(){this.parentNode.removeChild(this)}})}),[].includes||(Array.prototype.includes=function(searchElement){"use strict";var O=Object(this),len=parseInt(O.length)||0;if(0===len)return!1;var k,currentElement,n=parseInt(arguments[1])||0;for(0<=n?k=n:(k=len+n)<0&&(k=0);k<len;){if(searchElement===(currentElement=O[k])||searchElement!=searchElement&&currentElement!=currentElement)return!0;k++}return!1});var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}(),__assign=this&&this.__assign||function(){return(__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};!function(ProcessOut){!function(Flow){Flow[Flow.None=1]="None",Flow[Flow.OneOff=2]="OneOff",Flow[Flow.Subscription=3]="Subscription",Flow[Flow.Tokenization=4]="Tokenization"}(ProcessOut.Flow||(ProcessOut.Flow={}))}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ActionFlow,MockedIFrameWindow=function(){function MockedIFrameWindow(el,iframe){if(this.element=el,this.iframe=iframe,window.addEventListener("resize",function(event){var width=Math.max(document.body.clientWidth,document.documentElement.clientWidth);this.element.style.width=width+"px";var height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight);this.element.style.height=height+"px"}.bind(this)),"function"==typeof Event)var event=new Event("resize");else(event=document.createEvent("Event")).initEvent("resize",!0,!0);window.dispatchEvent(event)}return MockedIFrameWindow.prototype.open=function(url){this.iframe.setAttribute("src",url),document.body.style.overflow="hidden",document.body.appendChild(this.element)},MockedIFrameWindow.prototype.close=function(){document.body.style.overflow="",this.closed=!0,this.element.remove()},MockedIFrameWindow}();!function(ActionFlow){ActionFlow[ActionFlow.NewTab=0]="NewTab",ActionFlow[ActionFlow.NewWindow=1]="NewWindow",ActionFlow[ActionFlow.IFrame=2]="IFrame",ActionFlow[ActionFlow.FingerprintIframe=3]="FingerprintIframe",ActionFlow[ActionFlow.CurrentWindow=4]="CurrentWindow"}(ActionFlow=ProcessOut.ActionFlow||(ProcessOut.ActionFlow={}));var ActionHandlerOptions=function(){function ActionHandlerOptions(actionType,gatewayLogo,override){switch(this.iframeWidth=440,this.iframeHeight=480,this.gatewayLogo=gatewayLogo,actionType){case ActionHandlerOptions.ThreeDSChallengeFlow:this.flow=ActionFlow.IFrame;break;case ActionHandlerOptions.ThreeDSChallengeFlowNoIframe:this.flow=ActionFlow.CurrentWindow;break;case ActionHandlerOptions.ThreeDSFingerprintFlow:this.flow=ActionFlow.FingerprintIframe;break;case"paypal":case"paypalexpresscheckout":case"paypal-rest":this.flow=ActionFlow.NewWindow,this.newWindowHeight=645,this.newWindowWidth=450;break;case"test-credit-card":case"test-alternative-payment":this.flow=ActionFlow.NewWindow,this.newWindowHeight=645,this.newWindowWidth=450;break;default:this.flow=ActionFlow.NewTab}this.flow==ActionFlow.NewWindow&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(this.flow=ActionFlow.NewTab),override&&(this.flow=ActionFlow.IFrame,this.iframeWidth=override.width,this.iframeHeight=override.height)}return ActionHandlerOptions.ThreeDSChallengeFlow="three-d-s-challenge-flow",ActionHandlerOptions.ThreeDSChallengeFlowNoIframe="three-d-s-challenge-flow-no-iframe",ActionHandlerOptions.ThreeDSFingerprintFlow="three-d-s-fingerprint-flow",ActionHandlerOptions}();ProcessOut.ActionHandlerOptions=ActionHandlerOptions;var ActionHandler=function(){function ActionHandler(instance,options){if(this.canceled=!1,this.newWindowName="processout.checkout-window",this.instance=instance,this.options=options,this.options||(this.options=new ActionHandlerOptions),this.options.flow==ActionFlow.IFrame){var iframeWrapper=document.createElement("div");iframeWrapper.id="processoutjs-action-modal",iframeWrapper.style.position="fixed",iframeWrapper.style.top="0",iframeWrapper.style.left="0",iframeWrapper.style.height="100%",iframeWrapper.style.width="100%",iframeWrapper.setAttribute("style","position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.5); z-index: 9999999; overflow: auto;");var iframe=document.createElement("iframe");iframe.setAttribute("style","margin: 1em auto; width: "+this.options.iframeWidth+"px; height: "+this.options.iframeHeight+'px; max-width: 100%; max-height: 100%; display: block; box-shadow: 0 15px 35px rgba(50, 50, 93, 0.1), 0 5px 15px rgba(0, 0, 0, 0.07); background-color: #ECEFF1; background-image: url("'+this.instance.endpoint("js","/images/loader.gif")+'"); background-repeat: no-repeat; background-position: center;")'),iframe.setAttribute("frameborder","0"),iframe.onload=function(){iframe.style.backgroundImage=null};var buttonWrapper=document.createElement("div");buttonWrapper.setAttribute("style","width: 100%; text-align: center; margin-bottom: 1em;");var button=document.createElement("div");button.setAttribute("style","cursor: pointer; color: white;"),button.innerHTML=ProcessOut.Translator.translateMessage("label.cancel","Cancel"),buttonWrapper.appendChild(button),iframeWrapper.appendChild(iframe),iframeWrapper.appendChild(buttonWrapper),this.iframeWrapper=new MockedIFrameWindow(iframeWrapper,iframe),button.onclick=function(){this.iframeWrapper.close()}.bind(this)}}return ActionHandler.prototype.handle=function(url,success,error){var _a,_b,timeout,topLayer,newWindow,t=this,refocus=function(){topLayer&&topLayer.remove(),window.focus()};switch(this.options.flow){case ActionFlow.NewWindow:_a=this.createNewWindow(url),topLayer=_a.topLayer,newWindow=_a.newWindow;break;case ActionFlow.IFrame:(newWindow=this.iframeWrapper).open(url);break;case ActionFlow.FingerprintIframe:(newWindow=this.createFingerprintIFrame()).open(url),timeout=setTimeout(function(){clearInterval(timer),timer=null,newWindow.close(),error(new ProcessOut.Exception("three-d-s-2.fingerprint-timed-out"))},1e4);break;case ActionFlow.CurrentWindow:newWindow=window,window.location.replace(url);break;default:_b=this.createNewTabOrWindow(url),topLayer=_b.topLayer,newWindow=_b.newWindow}if(!newWindow)return error(new ProcessOut.Exception("customer.popup-blocked")),refocus(),null;var timer=setInterval(function(){if(timer){if(t.isCanceled())return clearInterval(timer),timer=null,newWindow.close(),error(new ProcessOut.Exception("customer.canceled")),void refocus();var cancelf=function(){clearInterval(timer),timer=null,error(new ProcessOut.Exception("customer.canceled")),refocus()};try{newWindow&&!newWindow.closed||cancelf()}catch(err){try{newWindow.close()}catch(err){}cancelf()}}},500);return this.listenEvents(newWindow,timer,refocus,function(data){timeout&&clearTimeout(timeout),success(data)},function(err){timeout&&clearTimeout(timeout),error(err)}),this},ActionHandler.prototype.createNewTabOrWindow=function(url){var win=window.open(url,this.newWindowName);return this.setupWindowObject(win)},ActionHandler.prototype.createNewWindow=function(url){var h=this.options.newWindowHeight,w=this.options.newWindowWidth,y=window.top.outerHeight/2+window.top.screenY-h/2,x=window.top.outerWidth/2+window.top.screenX-w/2,win=window.open(url,this.newWindowName,"menubar=false,toolbar=false,width="+w+",height="+h+",top="+y+",left="+x);return this.setupWindowObject(win)},ActionHandler.prototype.setupWindowObject=function(newWindow){if(!newWindow)return{};var ret={topLayer:null,newWindow:newWindow},onunload=function(e){try{ret.newWindow.close()}catch(err){}};window.addEventListener("beforeunload",onunload,!1),window.addEventListener("pagehide",onunload,!1),ret.topLayer=document.createElement("div"),ret.topLayer.id="processoutjs-action-modal",ret.topLayer.setAttribute("style","position: fixed; top: 0; left: 0; background: rgba(0, 0, 0, 0.7); z-index: 9999999; overflow: auto; height: 100%; width: 100%;");var topLayerMessage=document.createElement("div");if(topLayerMessage.setAttribute("style","text-align: center; color: white; max-width: 350px; margin: 0 auto; margin-top: 10%; cursor: pointer;"),this.options.gatewayLogo){var topLayerMessageImage=document.createElement("img");topLayerMessageImage.setAttribute("style","max-height: 70px; max-width: 230px; filter: saturate(0) grayscale(1) brightness(0.6) contrast(100000) invert(1); margin-bottom: 2em;"),topLayerMessageImage.setAttribute("src",this.options.gatewayLogo),topLayerMessage.appendChild(topLayerMessageImage)}var topLayerMessageText=document.createElement("div");topLayerMessageText.innerHTML=ProcessOut.Translator.translateMessage("label.apm-description"),topLayerMessage.appendChild(topLayerMessageText),ret.topLayer.appendChild(topLayerMessage),topLayerMessage.addEventListener("click",function(){ret.newWindow.focus()}.bind(this),!1);var topLayerCancel=document.createElement("div");return topLayerCancel.setAttribute("style","text-align: center; color: white; max-width: 350px; margin: 0 auto; margin-top: 3em; cursor: pointer; opacity: 0.9;"),topLayerCancel.innerHTML=ProcessOut.Translator.translateMessage("label.cancel"),ret.topLayer.appendChild(topLayerCancel),topLayerCancel.addEventListener("click",function(){this.cancel()}.bind(this),!1),document.body.appendChild(ret.topLayer),ret},ActionHandler.prototype.createFingerprintIFrame=function(){var iframeWrapper=document.createElement("div");iframeWrapper.id="processoutjs-fingerprint-wrapper",iframeWrapper.style.height="0",iframeWrapper.style.width="0";var iframe=document.createElement("iframe");return iframe.style.display="none",iframe.setAttribute("frameborder","0"),iframeWrapper.appendChild(iframe),new MockedIFrameWindow(iframeWrapper,iframe)},ActionHandler.prototype.listenEvents=function(newWindow,timer,refocus,success,error){var cur=++ActionHandler.listenerCount,alreadyDone=!1,handler=function(event){var data=ProcessOut.Message.parseEvent(event);if(data.namespace==ProcessOut.Message.checkoutNamespace)if(ActionHandler.listenerCount==cur){if(!alreadyDone)switch(alreadyDone=!0,data.action){case"success":timer&&(clearInterval(timer),timer=null),newWindow.close(),success(data.data),refocus();break;case"canceled":timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception("customer.canceled")),refocus();break;case"none":timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception("processout-js.no-customer-action")),refocus();break;case"error":timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception(data.errorCode,data.errorMessage)),refocus();break;default:timer&&(clearInterval(timer),timer=null),newWindow.close(),error(new ProcessOut.Exception("default")),refocus()}}else timer&&(clearInterval(timer),timer=null)};window.addEventListener("message",handler),new ProcessOut.MessageHub(this.instance,null,function(k,v){var data=ProcessOut.Message.parseEvent({data:v});data.namespace=k,handler({data:JSON.stringify(data)})})},ActionHandler.prototype.cancel=function(){this.canceled=!0},ActionHandler.prototype.isCanceled=function(){return this.canceled},ActionHandler.listenerCount=0,ActionHandler}();ProcessOut.ActionHandler=ActionHandler}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ApplePay=function(){function ApplePay(instance,req){this.instance=instance,req.merchantCapabilities&&req.merchantCapabilities.length||(req.merchantCapabilities=["supports3DS"]),req.supportedNetworks&&req.supportedNetworks.length||(req.supportedNetworks=["amex","discover","masterCard","visa"]),this.request=req,this.session=new ApplePaySession(1,this.request);var t=this;this.session.onvalidatemerchant=function(event){t.instance.apiRequest("post",t.instance.endpoint("api","/applepay/sessions"),{session_url:event.validationURL,domain_name:window.location.hostname,merchant_certificate_id:t.request.merchantCertificateId,applepay_mid:t.request.merchantApplePayCertificateId},function(data,req,e){data.success?t.session.completeMerchantValidation(data.session_payload):(t.onerror(new ProcessOut.Exception(data.error_code,data.message)),t.session.abort())},function(req,e,errorCode){t.onerror(new ProcessOut.Exception(errorCode)),t.session.abort()})},this.session.onpaymentauthorized=function(event){var req=t.data;(req=req||{}).applepay_response=event.payment,req.token_type="applepay",req.applepay_mid=t.request.merchantApplePayCertificateId,t.instance.apiRequest("post",t.instance.endpoint("api","/cards"),req,function(data,req,e){data.success?t.onsuccess(data.card,data.card):(t.onerror(new ProcessOut.Exception(data.error_code,data.message)),t.session.abort())},function(req,e,errorCode){t.onerror(new ProcessOut.Exception(errorCode)),t.session.abort()}),t.onpaymentauthorizedPostprocess(event)},this.onpaymentauthorizedPostprocess=this.onPaymentAuthorizedPostprocessHandler.bind(this),this.session.oncancel=this.onCancelHandler.bind(this),this.session.onshippingcontactselected=this.onShippingContactSelectedHandler.bind(this),this.session.onshippingmethodselected=this.onShippingMethodSelectedHandler.bind(this)}return ApplePay.prototype.setHandlers=function(onsuccess,onerror){if(!onsuccess)throw new ProcessOut.Exception("applepay.no-success-handler");this.onsuccess=onsuccess,this.onerror=function(err){onerror&&onerror(err)}},ApplePay.prototype.tokenize=function(data,onsuccess,onerror){this.setHandlers(onsuccess,onerror),this.data=data,this.session.begin()},ApplePay.prototype.abort=function(){this.session.abort()},ApplePay.prototype.completePayment=function(status){this.session.completePayment(status)},ApplePay.prototype.completePaymentMethodSelection=function(newTotal,newLineItems){this.session.completePaymentMethodSelection(newTotal,newLineItems)},ApplePay.prototype.completeShippingContactSelection=function(status,newShippingMethods,newTotal,newLineItems){this.session.completeShippingContactSelection(status,newShippingMethods,newTotal,newLineItems)},ApplePay.prototype.completeShippingMethodSelection=function(status,newTotal,newLineItems){this.session.completeShippingMethodSelection(status,newTotal,newLineItems)},ApplePay.prototype.getSession=function(){return this.session},ApplePay.prototype.onCancelHandler=function(event){this.oncancel&&this.oncancel(event)},ApplePay.prototype.onPaymentMethodSelectedHandler=function(event){this.onpaymentmethodselected&&this.onpaymentmethodselected(event)},ApplePay.prototype.onShippingContactSelectedHandler=function(event){this.onshippingcontactselected&&this.onshippingcontactselected(event)},ApplePay.prototype.onShippingMethodSelectedHandler=function(event){this.onshippingmethodselected&&this.onshippingmethodselected(event)},ApplePay.prototype.onPaymentAuthorizedPostprocessHandler=function(event){this.onpaymentauthorizedPostprocess&&this.onpaymentauthorizedPostprocess(event)},ApplePay}();ProcessOut.ApplePay=ApplePay}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ApplePayWrapper=function(){function ApplePayWrapper(instance){this.instance=instance}return ApplePayWrapper.prototype.checkAvailability=function(callback,req){window.ApplePaySession&&ApplePaySession.canMakePayments()?(req=req||{},this.instance.apiRequest("get",this.instance.endpoint("api","/applepay/available"),{domain_name:window.location.hostname,applepay_mid:req.merchantApplePayCertificateId||""},function(data,req,e){data.success?callback(null):callback(new ProcessOut.Exception("applepay.not-available",data.message))}.bind(this),function(req,e,errorCode){callback(new ProcessOut.Exception(errorCode))})):callback(new ProcessOut.Exception("applepay.not-supported"))},ApplePayWrapper.prototype.newSession=function(req,onsuccess,onerror){return new ProcessOut.ApplePay(this.instance,req)},ApplePayWrapper}();ProcessOut.ApplePayWrapper=ApplePayWrapper}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ThreeDS=function(){function ThreeDS(instance,options){if(this.instance=instance,!options.source)throw new ProcessOut.Exception("request.validation.error","Please provide a source to be used to start the 3-D Secure flow.");var url=options.url;if(!url&&options.invoiceID&&(url="/"+this.instance.getProjectID()+"/"+options.invoiceID+"/three-d-s/redirect/"+options.source+"?processoutjs=true"),!url&&(url="/"+this.instance.getProjectID()+"/three-d-s?processoutjs=true&amount="+encodeURIComponent(options.amount)+"&currency="+encodeURIComponent(options.currency)+"&name="+encodeURIComponent(options.name)+"&return_url="+encodeURIComponent(options.returnURL?options.returnURL:"")+"&source="+encodeURIComponent(options.source),options.metadata&&"object"==typeof options.metadata))for(var i in options.metadata)options.metadata.hasOwnProperty(i)&&(url+="&metadata["+i+"]="+encodeURIComponent(options.metadata[i]));if(!url)throw new ProcessOut.Exception("request.validation.error","Please provide a 3DS challenge URL or an invoice ID.");this.url=url}return ThreeDS.prototype.handle=function(success,error){return this.instance.handleAction(this.instance.endpoint("checkout",this.url),function(invoiceID){success(invoiceID)},error,new ProcessOut.ActionHandlerOptions(ProcessOut.ActionHandlerOptions.ThreeDSChallengeFlow))},ThreeDS}();ProcessOut.ThreeDS=ThreeDS}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ThreeDSOptions=function ThreeDSOptions(){};ProcessOut.ThreeDSOptions=ThreeDSOptions;var ThreeDSWrapper=function(){function ThreeDSWrapper(instance){this.instance=instance}return ThreeDSWrapper.prototype.authenticate=function(options,success,error){return new ProcessOut.ThreeDS(this.instance,options).handle(success,error)},ThreeDSWrapper}();ProcessOut.ThreeDSWrapper=ThreeDSWrapper}(ProcessOut=ProcessOut||{}),function(ProcessOut){var GatewayRequest=function(){function GatewayRequest(){}return GatewayRequest.prototype.token=function(){return"gway_req_"+btoa(JSON.stringify({gateway_configuration_id:this.gatewayConfigurationID,url:this.url,method:this.method,headers:this.headers,body:this.body,prepare:this.prepare}))},GatewayRequest}();ProcessOut.GatewayRequest=GatewayRequest}(ProcessOut=ProcessOut||{}),function(ProcessOut){var CardHolder=function CardHolder(){};ProcessOut.CardHolder=CardHolder;var Expiry=function(){function Expiry(month,year){this.month=month,this.year=Expiry.parseYear(year)}return Expiry.parse=function(exp){var exps=exp.split(" / ");exps.length<=1&&(exps=exp.split("/"));var month=Number(exps[0]),year=0;return 1<exps.length&&(year=Number(exps[1])),new Expiry(month,year)},Expiry.parseMonth=function(monthn){var month=Number(monthn);return month=month||0},Expiry.parseYear=function(yearn){var year=Number(yearn);return(year=year||0)<2e3&&(year+=2e3),year},Expiry.prototype.getMonth=function(){return this.month},Expiry.prototype.getYear=function(){return this.year},Expiry.prototype.string=function(){return this.month+" / "+this.year},Expiry.prototype.validate=function(){var err=Expiry.validateMonth(this.getMonth());if(err)return err;if(err=Expiry.validateYear(this.getYear()))return err;var date=new Date;return this.getMonth()<date.getMonth()&&this.getYear()==date.getFullYear()?new ProcessOut.Exception("card.invalid-date"):null},Expiry.format=function(exp){var res=exp;return 4===res.length&&(res=res.slice(0,-3)),res.replace(/\s/g,"").replace(/^([1-9]\/|[2-9])$/g,"0$1/").replace(/^(0[1-9]|1[0-2])$/g,"$1/").replace(/^1([3-9])$/g,"01/$1").replace(/^(0[1-9]|1[0-2])([0-9][0-9])$/,"$1/$2").replace(/^0\/|0+$/g,"0").replace(/[^\d|^\/]*/g,"").replace(/(\/.*)\//g,"$1").replace(/\//g," / ")},Expiry.validateMonth=function(month){return!month||month<1||12<month?new ProcessOut.Exception("card.invalid-month"):null},Expiry.validateYear=function(year){year<100&&(year+=2e3);var date=new Date;return!year||year<date.getFullYear()?new ProcessOut.Exception("card.invalid-year"):null},Expiry}();ProcessOut.Expiry=Expiry;var Card=function(){function Card(number,expiry,cvc){this.number=Card.parseNumber(number),this.cvc=cvc,this.expiry=expiry}return Card.prototype.getNumber=function(){return this.number},Card.prototype.getExpiry=function(){return this.expiry},Card.prototype.getCVC=function(){return this.cvc},Card.luhn=function(cardNo){for(var s=0,doubleDigit=!1,i=cardNo.length-1;0<=i;i--){var digit=+cardNo[i];doubleDigit&&9<(digit*=2)&&(digit-=9),s+=digit,doubleDigit=!doubleDigit}return s%10==0},Card.prototype.validate=function(){var iin=this.getIIN(),scheme=Card.getPossibleSchemes(iin)[0],lengths=Card.getPossibleCardLength(iin),err=Card.validateNumber(this.number,lengths);return err||(null==this.expiry?new ProcessOut.Exception("card.invalid-date"):(err=this.expiry.validate())||Card.validateCVC(this.cvc,scheme))},Card.prototype.getIIN=function(){return Card.getIIN(this.number)},Card.prototype.getLast4Digits=function(){return Card.getLast4Digits(this.number)},Card.formatNumber=function(number){var format=Card.getCardFormat(Card.getIIN(number));number=Card.parseNumber(number);for(var formatted="",currentBlock=0,currentBlockChar=0,i=0;i<number.length;i++)if(!isNaN(number[i])){if(currentBlockChar>=format[currentBlock]){if(currentBlockChar=0,++currentBlock>=format.length)break;formatted+=" "}formatted+=number[i],currentBlockChar++}return formatted},Card.parseNumber=function(number){return String(number.replace(/ /gi,"").replace(/\-/gi,"").replace(/\-/gi,""))},Card.validateNumber=function(number,limit){return!((number=Card.parseNumber(number)).length<limit[0]||number.length>limit[1])&&Card.luhn(number)?null:new ProcessOut.Exception("card.invalid-number")},Card.validateCVC=function(cvc,scheme){if(scheme){if("american-express"===scheme){if(cvc&&!cvc.match(/^\d{4}$/g))return new ProcessOut.Exception("card.invalid-cvc")}else if(cvc&&!cvc.match(/^\d{3}$/g))return new ProcessOut.Exception("card.invalid-cvc")}else if(cvc&&!cvc.match(/^\d{3,4}$/g))return new ProcessOut.Exception("card.invalid-cvc");return null},Card.getIIN=function(number){var l=(number=Card.parseNumber(number)).length;return 6<l&&(l=6),number.substring(0,l)},Card.getLast4Digits=function(number){var l=(number=Card.parseNumber(number)).length;return 4<l&&(l=4),number.substr(number.length-l)},Card.autoFormatNumber=function(number,next){var lastLen=0;number.addEventListener("input",function(e){var cursor=this.selectionStart,l=this.value.length;this.value=Card.formatNumber(this.value),cursor&&cursor<l&&(this.setSelectionRange(cursor,cursor),0<cursor&&" "==this.value[cursor-1]&&lastLen<l&&this.setSelectionRange(cursor+1,cursor+1));var cardLength=Card.getPossibleCardLength(Card.getIIN(this.value));next&&lastLen<l&&Card.parseNumber(this.value).length==cardLength[1]&&next(),lastLen=l})},Card.autoFormatExpiry=function(exp,next){var lastLen=0;exp.addEventListener("input",function(e){var l=this.value.length;this.value=Expiry.format(this.value.substring(0,7)),next&&lastLen<l&&7==this.value.length&&next(),lastLen=l})},Card.autoFormatCvc=function(cvc){cvc.addEventListener("keydown",function(e){var isNumericInput=/\d/.test(e.key);(!(1!==e.key.length||isNumericInput||e.ctrlKey||e.metaKey)||isNumericInput&&3<this.value.length)&&e.preventDefault()})},Card.getCardFormat=function(iin){var schemes=Card.getPossibleSchemes(iin);return 1==schemes.length&&"american-express"==schemes[0]?[4,6,5]:[4,4,4,4,4]},Card.getPossibleCardLength=function(iin){for(var minLength=19,maxLength=12,schemes=Card.getPossibleSchemes(iin),i=0;i<schemes.length;i++)switch(schemes[i]){case"visa":minLength=Math.min(minLength,16),maxLength=Math.max(maxLength,19);break;case"mastercard":case"instapayment":case"jcb":case"cardguard ead bg ils":case"elo":case"hipercard":minLength=Math.min(minLength,16),maxLength=Math.max(maxLength,16);break;case"american-express":case"uatp":minLength=Math.min(minLength,15),maxLength=Math.max(maxLength,15);break;case"diners-club":minLength=Math.min(minLength,14),maxLength=Math.max(maxLength,16);break;case"union-pay":case"discover":case"interpayment":case"dankort":case"naranja":case"cabal":case"argencard":minLength=Math.min(minLength,16),maxLength=Math.max(maxLength,19);break;case"maestro":minLength=Math.min(minLength,12),maxLength=Math.max(maxLength,19)}return maxLength<minLength&&(minLength=12,maxLength=19),[minLength,maxLength]},Card.getPossibleSchemes=function(iin){iin=Card.parseNumber(iin);var schemes={visa:["4"],mastercard:["22","23","24","25","26","27","51","52","53","54","55"],"american-express":["34","37"],"union-pay":["62"],"diners-club":["300","301","302","303","304","305","309","36","38","39"],discover:["6011","62","64","65"],jcb:["35"],maestro:["50","56","57","58","59","6"],dankort:["5019","4175","4571"],uatp:["1"],"cardguard ead bg ils":["5392"],hipercard:["606282"],elo:["401178","401179","438935","451416","457632","457393","431274","438935","457631","457632","506699","50670","50671","50672","50673","50674","50675","50676","506770","506771","506772","506773","506774","506775","506776","506777","506778","504175","509","627780","636297","636368","651652","651653","651654","651655","651656","651657","651658","651659","65166","65167","650031","650032","650033","650035","650036","650037","650038","650039","65004","650050","650051","65500","65501","650485","650486","650487","650488","650489","65049","65050","65051","65052","650530","650531","650532","650533","650534","650535","650536","650537","650538","650541","650542","650543","650544","650545","650546","650547","650548","650549","65055","65056","65057","65058","650590","650591","650592","650593","650594","650595","650596","650597","650598","65070","650710","650711","650712","650713","650714","650715","650716","650717","650718","650720","650721","650722","650723","650724","650725","650726","650727","655021","655022","655023","655024","655025","655026","655027","655028","655029","65503","65504","655050","655051","655052","655053","655054","655055","655056","655057","655058","650901","650902","650903","650904","650905","650906","650907","650908","650909","65091","65092","65093","65094","65095","65096","650970","650971","650972","650973","650974","650975","650976","650977","650978","650405","650406","650407","650408","650409","65041","65042","65043"],naranja:["377798","377799","402917","402918","527571","527572","589562"],cabal:["589657","600691","603522","6042","6043","636908"],argencard:["501105"],"carte bancaire":["49707","49783","49771","45950","45334","51336","49836","47722","45721","54515","49732","51345","45626","49774","49734","49738","40220","53253","56125","49835","49715","58171","45619","45954","49793","43782","41506","49773","53710","51338","53102","45940","45627","49766","46978","49720","45611","49902","55700","49796","49733","45930","55961","49792","51348","52945","49708","49726","45610","44995","49739","41507","47717","54985","58170","51327","47260","45335","43951","51365","43950","49746","40100","45629","49731","51810","45332","42011","55420","42346","41993","45333","49723","51361","49719","45929","55426","44244","51330","55981","49752","45621","49764","49755","51321","45615","49765","51375","47802","51372","49742","51377","55886","49837","51623","46983","49716","55391","67759","45613","45568","49758","46609","47480","44841","45958","51320","47729","51319","49722","51317","49745","67117","49797","51313","49714","49704","47726","44996","42012","49791","49749","51341","41503","51325","55980","46657","49711","52948","51371","49717","49838","51314","46703","40355","51324","51350","55892","53103","51353","43783","55496","49839","45612","45620","46547","51316","49763","49721","51379","49728","49770","49776","51521","49909","45616","52954","51312","49901","45939","49712","49775","45720","52166","49735","46982","51337","46361","51374","49788","47961","49785","49741","51385","46986","51364","49795","51992","49703","45937","51323","52931","45617","49760","53119","49709","49724","45566","45623","52922","46969","53506","51360","47427","45560","40593","45628","51357","41505","51315","45337","52942","53610","53611","40594","45624","48651","51366","45567","46896","40657","51750","52933","49756","52943","49790","54953","49761","45056","48373","49906","47809","54284","48369","51332","55399","44855","40223","49777","43787","58175","41509","45614","48160","51301","49754","49753","45054","46980","49737","52920","51356","49713","49706","49725","51390","49779","51370","51318","47268","51354","49750","51386","40221","51367","49744","49730","51373","45771","51736","45745","53411","52371","51300","43953","47718","49748","58177","53711","58176","52886","48362","45330","44245","49740","45622","46625","41717","51302","44997","52944","51369","49747","49772","58178","49768","52941","51363","51362","49781","45618","53234","49789","51326","49799","40209","45331","49702","58173","58174","49743","51352","51311","45625","51335","49905","49786","41628","49798","58179","53801","49767","45339","49769","53250","51328","49782","53410","58172","49778","45051","49736","49718","49900","49903","49784","55397","46321","51376","51331","49710","56124","44853","49759","51351","52949","53532","49904","49787","51322","49762","55888","51620","49794","51355","45932","52946","49780","49757","49729","52947","51310","51329","53502","49751","53255","51378","51303","49727","45933"],bancontact:["6703","487104","670305","670330","670319","670300","670342","487109","670397","670375","670310"]},matches=new Array;for(var scheme in schemes){var options=schemes[scheme];for(var optionKey in options){var option=options[optionKey],l=iin.length>option.length?option.length:iin.length;if(iin.substring(0,l)==option.toString().substring(0,l)){matches.push(scheme);break}}}return matches},Card}();ProcessOut.Card=Card}(ProcessOut=ProcessOut||{}),function(ProcessOut){var CardFieldValue=function CardFieldValue(){this.number=null,this.expiryMonth=null,this.expiryYear=null,this.cvc=null,this.name=null,this.metadata=null};ProcessOut.CardFieldValue=CardFieldValue;var CardFieldOptions=function(){function CardFieldOptions(type){this.expiryAutoNext=!0,this.cardNumberAutoNext=!0,this.type=type}return CardFieldOptions.prototype.apply=function(o){return o.placeholder&&(this.placeholder=o.placeholder),o.style&&(this.style=o.style),null!=o.requireCVC&&(this.requireCVC=o.requireCVC),o.expiryAutoNext!==undefined&&null!==o.expiryAutoNext&&(this.expiryAutoNext=o.expiryAutoNext),o.cardNumberAutoNext!==undefined&&null!==o.cardNumberAutoNext&&(this.cardNumberAutoNext=o.cardNumberAutoNext),this},CardFieldOptions}();ProcessOut.CardFieldOptions=CardFieldOptions;var CardFieldStyle=function CardFieldStyle(){};ProcessOut.CardFieldStyle=CardFieldStyle;var CardField=function(){function CardField(instance,form,options,container,success,error){if(this.handlers={},!options||!options.type)throw new ProcessOut.Exception("processout-js.invalid-field-type","Options and a the field type must be provided to setup the field.");if(!container)throw new ProcessOut.Exception("processout-js.undefined-field","The card field for the "+options.type+" does not exist in the given container.");if(container instanceof HTMLInputElement)throw new ProcessOut.Exception("processout-js.invalid-field","The card field for the "+options.type+" must be an input field.");if(options.type!=CardField.number&&options.type!=CardField.expiry&&options.type!=CardField.expiryMonth&&options.type!=CardField.expiryYear&&options.type!=CardField.cvc)throw new ProcessOut.Exception("processout-js.invalid-field-type");this.instance=instance,this.form=form,this.options=options,this.el=container;var placeholder=this.el.getAttribute("data-processout-placeholder");placeholder&&(this.options.placeholder=placeholder),this.spawn(success,error)}return CardField.prototype.spawn=function(success,error){var tmp=Math.random().toString(36).substring(7);this.uid="#"+tmp;var endpoint=this.instance.getProcessOutFieldEndpoint("?r="+tmp+this.uid);this.iframe=document.createElement("iframe"),this.iframe.className="processout-field-cc-iframe",this.iframe.name=tmp,this.iframe.setAttribute("src",endpoint),this.iframe.setAttribute("style","background: none; width: 100%;"),this.iframe.setAttribute("frameborder","0"),this.iframe.setAttribute("allowtransparency","1"),this.iframe.style.display="none";var errored=!(this.iframe.height="14px"),iframeError=setTimeout(function(){errored=!0,typeof error==typeof Function&&error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout);this.iframe.onload=function(){try{navigator.userAgent.match(/firefox|fxios/i)&&this.iframe.contentWindow.location.replace(endpoint)}catch(e){}}.bind(this),window.addEventListener("message",function(event){if(!errored){var data=ProcessOut.Message.parseEvent(event);data.frameID==this.uid&&data.namespace==ProcessOut.Message.fieldNamespace&&(this.handlEvent(data),"alive"==data.action&&this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"setup",formID:this.form.getUID(),data:this.options}),"*"),"ready"==data.action&&(this.iframe.style.display="block",clearTimeout(iframeError),success(),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"resize"}),"*"),this.iframe.addEventListener("focus",function(event){this.focus()}.bind(this))))}}.bind(this)),this.el.appendChild(this.iframe)},CardField.prototype.handlEvent=function(data){var d={field:this,type:this.options.type,element:this.el,data:data.data};switch(data.action){case"inputEvent":this.eventCallback&&this.eventCallback("oninput",d);break;case"mouseEnterEvent":this.eventCallback&&this.eventCallback("onmouseenter",d);break;case"mouseLeaveEvent":this.eventCallback&&this.eventCallback("onmouseleave",d);break;case"focusEvent":this.el.className=this.el.className+" processout-input-focused",this.eventCallback&&this.eventCallback("onfocus",d);break;case"blurEvent":this.el.className=this.el.className.replace(/\bprocessout-input-focused\b/g,"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),this.eventCallback&&this.eventCallback("onblur",d);break;case"next":this.next&&this.next();break;case"event":if(data.data.name in this.handlers)for(var handlers=this.handlers[data.data.name],i=0;i<handlers.length;i++)handlers[0](data.data.data);break;case"resize":this.options.style.height?this.iframe.height=this.options.style.height:this.iframe.height=data.data}},CardField.prototype.setNext=function(next){this.next=next},CardField.prototype.update=function(options){options.placeholder&&(this.options.placeholder=options.placeholder),options.style&&(this.options.style=Object.assign(this.options.style,options.style)),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"update",data:this.options}),"*")},CardField.prototype.addEventListener=function(e,h){e in this.handlers||(this.handlers[e]=[]),this.handlers[e].push(h),this.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"registerEvent",data:e}),"*")},CardField.prototype.on=function(e,h){return this.addEventListener(e,h)},CardField.prototype.blur=function(){this.iframe.contentWindow.postMessage(JSON.stringify({messageID:Math.random().toString(),namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"blur"}),"*")},CardField.prototype.focus=function(){this.iframe.contentWindow.postMessage(JSON.stringify({messageID:Math.random().toString(),namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"focus"}),"*")},CardField.prototype.validate=function(success,error){var id=Math.random().toString();this.iframe.contentWindow.postMessage(JSON.stringify({messageID:id,namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"validate"}),"*");var fetchingTimeout=setTimeout(function(){error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout);window.addEventListener("message",function(event){var data=ProcessOut.Message.parseEvent(event);data.frameID==this.uid&&data.namespace==ProcessOut.Message.fieldNamespace&&data.messageID==id&&"validate"==data.action&&(clearTimeout(fetchingTimeout),data.data?error(new ProcessOut.Exception(data.data)):success())}.bind(this))},CardField.prototype.tokenize=function(fields,data,success,error){var id=Math.random().toString();this.iframe.contentWindow.postMessage(JSON.stringify({messageID:id,namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"tokenize",data:{fields:fields,data:data}}),"*");var fetchingTimeout=setTimeout(function(){error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout);window.addEventListener("message",function(event){var data=ProcessOut.Message.parseEvent(event);data.messageID==id&&"tokenize"==data.action&&(clearTimeout(fetchingTimeout),data.data.token?success(data.data.token,data.data.card):data.data.error?error(new ProcessOut.Exception(data.data.error.code,data.data.error.message)):error(new ProcessOut.Exception("default")))}.bind(this))},CardField.prototype.refreshCVC=function(cardUID,success,error){var id=Math.random().toString();this.iframe.contentWindow.postMessage(JSON.stringify({messageID:id,namespace:ProcessOut.Message.fieldNamespace,projectID:this.instance.getProjectID(),action:"refresh-cvc",data:cardUID}),"*");var fetchingTimeout=setTimeout(function(){error(new ProcessOut.Exception("processout-js.field.unavailable"))},CardField.timeout);window.addEventListener("message",function(event){var data=ProcessOut.Message.parseEvent(event);data.messageID==id&&"refresh-cvc"==data.action&&(clearTimeout(fetchingTimeout),data.data.token?success(data.data.token):data.data.error?error(new ProcessOut.Exception(data.data.error.code,data.data.error.message)):error(new ProcessOut.Exception("default")))}.bind(this))},CardField.number="number",CardField.expiry="expiry",CardField.expiryMonth="expiry-month",CardField.expiryYear="expiry-year",CardField.cvc="cvc",CardField.timeout=2e4,CardField}();ProcessOut.CardField=CardField}(ProcessOut=ProcessOut||{}),function(ProcessOut){var CardForm=function(){function CardForm(instance,el){this.instance=instance,this.element=el,this.uid=Math.random().toString()}return CardForm.prototype.getUID=function(){return this.uid},CardForm.prototype.setup=function(options,success,error){var numberReady=!1,cvcReady=!1,expMonthReady=!1,expYearReady=!1,ev=function(opts){if(numberReady&&cvcReady&&expMonthReady&&expYearReady)return opts&&opts.cardNumberAutoNext&&this.number.setNext(function(){this.exp&&this.exp.focus(),this.expMonth&&this.expMonth.focus()}.bind(this)),this.exp&&opts&&opts.expiryAutoNext&&this.exp.setNext(function(){this.cvc&&this.cvc.focus()}.bind(this)),void success(this)}.bind(this);this.number=new ProcessOut.CardField(this.instance,this,new ProcessOut.CardFieldOptions(ProcessOut.CardField.number).apply(options),this.element.querySelector("[data-processout-input=cc-number]"),function(){numberReady=!0,ev()},error);var cvcEl=this.element.querySelector("[data-processout-input=cc-cvc]");if(cvcEl){var opts_1=new ProcessOut.CardFieldOptions(ProcessOut.CardField.cvc).apply(options);this.cvc=new ProcessOut.CardField(this.instance,this,opts_1,cvcEl,function(){cvcReady=!0,ev(opts_1)},error)}else cvcReady=!0;var expEl=this.element.querySelector("[data-processout-input=cc-exp]");if(expEl){var opts_2=new ProcessOut.CardFieldOptions(ProcessOut.CardField.expiry).apply(options);this.exp=new ProcessOut.CardField(this.instance,this,opts_2,expEl,function(){expYearReady=expMonthReady=!0,ev(opts_2)},error)}else{var expiryMonthOpts_1=new ProcessOut.CardFieldOptions(ProcessOut.CardField.expiryMonth).apply(options);this.expMonth=new ProcessOut.CardField(this.instance,this,expiryMonthOpts_1,this.element.querySelector("[data-processout-input=cc-exp-month]"),function(){expMonthReady=!0,ev(expiryMonthOpts_1)},error);var expiryYearOpts_1=new ProcessOut.CardFieldOptions(ProcessOut.CardField.expiryYear).apply(options);this.expYear=new ProcessOut.CardField(this.instance,this,expiryYearOpts_1,this.element.querySelector("[data-processout-input=cc-exp-year]"),function(){expYearReady=!0,ev(expiryYearOpts_1)},error)}return this},CardForm.prototype.setupCVC=function(options,success,error){return this.isRefreshCVC=!0,this.cvc=new ProcessOut.CardField(this.instance,this,new ProcessOut.CardFieldOptions(ProcessOut.CardField.cvc).apply(options),this.element.querySelector("[data-processout-input=cc-cvc]"),function(){success(this)}.bind(this),error),this},CardForm.prototype.getElement=function(){return this.element},CardForm.prototype.addEventListener=function(type,listener,useCapture){return this.element.addEventListener(type,listener,useCapture)},CardForm.prototype.on=function(type,listener,useCapture){return this.element.addEventListener(type,listener,useCapture)},CardForm.prototype.getNumberField=function(){return this.number},CardForm.prototype.getCVCField=function(){return this.cvc},CardForm.prototype.getExpiryField=function(){return this.exp},CardForm.prototype.getExpiryMonthField=function(){return this.expMonth},CardForm.prototype.getExpiryYearField=function(){return this.expYear},CardForm.prototype.validate=function(success,error){if(this.isRefreshCVC)this.cvc.validate(function(){success()},error);else{var number=!1,cvc=!1,expMonth=!1,expYear=!1,ev=function(){number&&cvc&&expMonth&&expYear&&success()};this.number.validate(function(){number=!0,ev()},error),this.cvc?this.cvc.validate(function(){cvc=!0,ev()},error):cvc=!0,this.exp?this.exp.validate(function(){expYear=expMonth=!0,ev()},error):(this.expMonth.validate(function(){expMonth=!0,ev()},error),this.expYear.validate(function(){expYear=!0,ev()},error))}},CardForm.prototype.tokenize=function(data,success,error){var fields=["number"];this.cvc&&fields.push("cvc"),this.exp&&fields.push("exp"),this.expMonth&&fields.push("exp-month"),this.expYear&&fields.push("exp-year"),this.number.tokenize(fields,data,success,error)},CardForm.prototype.refreshCVC=function(cardUID,success,error){this.cvc||error(new ProcessOut.Exception("processout-js.wrong-type-for-action","RefreshCVC was called but the form has no CVC field initialized.")),this.cvc.refreshCVC(cardUID,success,error)},CardForm}();ProcessOut.CardForm=CardForm}(ProcessOut=ProcessOut||{}),function(ProcessOut){var errors={en:{"default":"An error occured: your payment was declined.","card.declined":"The credit card has been declined.","card.expired":"The given card has expired.","card.duplicate":"The payment could not be completed. Please try again later.","card.network-failed":"The payment could not be completed. Please try again later.","card.invalid":"The given card is invalid.","card.invalid-name":"The cardholder name is invalid.","card.invalid-number":"The card number is invalid.","card.invalid-expiry-date":"The card expiry date is invalid.","card.invalid-expiry-month":"The card expiry month is invalid.","card.invalid-expiry-year":"The card expiry year is invalid.","card.invalid-date":"The card expiry date is invalid.","card.invalid-month":"The card expiry month is invalid.","card.invalid-year":"The card expiry year is invalid.","card.invalid-cvc":"The card CVC is invalid.","card.missing-cvc":"The card CVC is required.","card.missing-cardholder-name":"The card holder name is required.","card.invalid-zip":"The card's ZIP code is valid.","card.failed-cvc-and-avs":"The CVC and AVS code were invalid.","card.failed-three-d-s":"The 3D-Secure authentication failed.","card.bad-track-data":"The card could not be verified. Maybe your CVC is invalid?","card.not-registered":"The card is not registered.","card.issuer-not-found":"The card issuer could not be found. Please try another card.","card.possible-fraud":"The payment could not be completed. Please contact your bank for further help.","card.contact-bank":"The payment could not be completed. Please contact your bank for further help.","card.not-authorized":"The payment could not be authorized using the provided card.","card.do-not-honor":"The payment could not be completed. Please contact your bank for further help.","card.maximum-attempts":"The card maximum attempts has been reached and the payment could not be processed.","card.stolen":"The payment could not be processed as the provided card was marked as stolen.","card.lost":"The payment could not be processed as the provided card was marked as lost.","card.exceeded-limits":"The payment could not be processed as the payment limits of the card have been exceeded.","card.no-money":"There doesn't seem to be enough money on the bank account linked to the provided card.","customer.canceled":"The customer canceled the payment.","customer.popup-blocked":"Please allow pop-ups to continue with your payment flow.","gateway.declined":"The payment was declined.","payment.declined":"The payment was declined.","payment.pending":"The payment is currently pending, please wait a few minutes for it to fully go through.","three-d-s-2.fingerprint-timed-out":"The 3-D Secure fingerprinting timed out.","request.validation.error":"The provided information is invalid or missing.","request.validation.invalid-country":"The provided country is invalid.","request.validation.missing-name":"A name must be provided.","request.validation.invalid-name":"The provided name is invalid.","request.validation.missing-email":"An email must be provided.","request.validation.invalid-email":"The provided email is invalid.","request.validation.invalid-address":"The provided address is invalid.","request.validation.no-method-selected":"Please select a payment method.","request.gateway.not-available":"The requested gateway is currently unavailable.","request.gateway.not-supported":"The gateway is not supported by ProcessOut.js","processout-js.missing-project-id":"Your project ID was not specified when loading ProcessOut.js.","processout-js.not-hosted":"ProcessOut.js was not loaded from ProcessOut CDN. Please do not host ProcessOut.js yourself but rather use ProcessOut CDN: https://js.processout.com/processout.js","processout-js.modal.unavailable":"The ProcessOut.js modal is unavailable.","processout-js.field.unavailable":"The ProcessOut.js credit card field is unavailable.","processout-js.invalid-config":"The provided gateway configuration is invalid.","processout-js.no-customer-action":"No customer action is required for the given gateway configuration and resource.","processout-js.customer-action-not-supported":"The requested customer action is not supported by ProcessOut.js.","processout-js.invalid-field":"The given HTML element may not be used by ProcessOut.js: it is an input. Please only use divs when creating a ProcessOut.js credit card field.","processout-js.undefined-field":"The given HTML element was undefined.","processout-js.invalid-field-type":"The given field type was incorrect. It must either be number, expiry, expiryMonth, expiryYear or CVC.","processout-js.invalid-type":"The specified parameter had an unknown type.","processout-js.missing-source":"A source must be specified.","processout-js.wrong-type-for-action":"The requested action could not be performed on the given field because its type is invalid.","processout-js.missing-invoice-id":"An invoice ID must be specified.","processout-js.missing-resource-id":"A resource ID must be specified.","processout-js.internal-server-error":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.not-implemented":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.invalid-response":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.service-unavailable":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.response-timeout":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.http-version-not-supported":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.network-auth-required":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.aborted-retries-exceeded":"There seems to be some issue preventing the payment from making it through. Please try again in a few minutes.","processout-js.network-issue":"There seems to be some connectivity issue preventing the payment from making it through. Please switch to another network or try again in a few minutes.","resource.invalid-type":"The provided resource was invalid. It must be an invoice, a subscription or an authorization request.","applepay.not-supported":"The current browser/device does not support Apple Pay.","applepay.no-success-handler":"A success handler must be specified when setting up Apple Pay.","applepay.not-available":"Apple Pay is not available for the current browser, device or ProcessOut project."},fr:{"default":"Une erreur est survenue lors du paiement."},es:{"default":"Ha ocurrido un error: el pago ha sido declinado.","card.declined":"La tarjeta ha sido declinada.","card.expired":"La tarjeta empleada ha caducado.","card.duplicate":"El pago no se ha podido completar. Por favor, intntelo ms tarde.","card.network-failed":"El pago no se ha podido completar. Por favor, intntelo ms tarde.","card.invalid":"La tarjeta empleada no es vlida.","card.invalid-name":"El nombre del titular de la tarjeta no es vlido.","card.invalid-number":"El nmero de la tarjeta no es vlido.","card.invalid-date":"La fecha de caducidad de la tarjeta no es vlida.","card.invalid-expiry-date":"La fecha de caducidad de la tarjeta no es vlida.","card.invalid-month":"El mes de caducidad de la tarjeta no es vlido.","card.invalid-expiry-month":"El mes de caducidad de la tarjeta no es vlido.","card.invalid-year":"El ao de caducidad de la tarjeta no es vlido.","card.invalid-expiry-year":"El ao de caducidad de la tarjeta no es vlido.","card.invalid-cvc":"El cdigo CVC de la tarjeta no es vlido.","card.missing-cvc":"El cdigo CVC de la tarjeta es obligatorio.","card.invalid-zip":"El cdigo ZIP de la tarjeta no es vlido.","card.failed-cvc-and-avs":"El cdigo CVC y el cdigo AVS no son vlidos.","card.failed-three-d-s":"La autenticacin 3DS ha fallado.","card.bad-track-data":"No ha sido posible verificar la tarjeta.","card.missing-cardholder-name":"El nombre del titular de la tarjeta es obligatorio.","card.not-registered":"La tarjeta no ha sido registrada.","card.issuer-not-found":"No se ha podido encontrar el emisor de la tarjeta. Por favor, intntelo con otra tarjeta.","card.possible-fraud":"El pago no se ha podido completar. Por favor, contacte con su banco para obtener ayuda.","card.contact-bank":"El pago no se ha podido completar. Por favor, contacte con su banco para obtener ayuda.","card.not-authorized":"El pago no se ha podido autorizar con la tarjeta proporcionada.","card.do-not-honor":"El pago no se ha podido completar. Por favor, contacte con su banco para obtener ayuda.","card.maximum-attempts":"Se ha alcanzado el nmero mximo de intentos con la tarjeta proporcionada y el pago no se ha podido procesar.","card.stolen":"El pago no se ha podido procesar porque la tarjeta proporcionada ha sido marcada como robada.","card.lost":"El pago no se ha podido procesar porque la tarjeta proporcionada ha sido marcada como perdida.","card.exceeded-limits":"El pago no se ha procesado porque se han excedido los lmites de pago de la tarjeta.","card.no-money":"Parece que no hay suficiente dinero en la cuenta bancaria vinculada a la tarjeta proporcionada.","customer.canceled":"El cliente ha cancelado el pago.","customer.popup-blocked":"Por favor, permita el uso de pop-ups en su navegador para continuar con el flujo de pago.","gateway.declined":"El pago ha sido rechazado.","payment.declined":"El pago ha sido rechazado.","payment.pending":"El pago est actualmente pendiente. Espere unos minutos hasta que se complete por completo.","three-d-s-2.fingerprint-timed-out":"La identificacin por huella digital 3-D Secure ha caducado.","request.validation.error":"La informacin proporcionada es invlida o no est presente en su totalidad.","request.validation.invalid-country":"El pas proporcionado no es vlido.","request.validation.missing-name":"Se debe proporcionar un nombre.","request.validation.invalid-name":"El nombre proporcionado no es vlido.","request.validation.missing-email":"Se debe proporcionar un email.","request.validation.invalid-email":"El email proporcionado no es vlido.","request.validation.invalid-address":"La direccin proporcionada no es vlida.","request.validation.no-method-selected":"Por favor, seleccione un mtodo de pago.","request.gateway.not-available":"La pasarela de pago solicitada no est disponible.","request.gateway.not-supported":"La pasarela de pago no es compatible.","resource.invalid-type":"El recurso proporcionado no es vlido. Debe ser un invoice, una suscripcin o una solicitud de autorizacin.","applepay.not-supported":"Su navegador o dispositivo actual no es compatible con Apple Pay."},pt:{"default":"Ocorreu um erro: o pagamento foi recusado.","card.declined":"O carto foi recusado.","card.expired":"O carto fornecido expirou.","card.duplicate":"O pagamento no foi concludo. Por favor, tente novamente.","card.network-failed":"O pagamento no foi concludo. Por favor, tente novamente.","card.invalid":"O carto fornecido  invlido.","card.invalid-name":"O nome do titular do carto  invlido.","card.invalid-number":"O nmero do carto  invlido.","card.invalid-date":"A data de validade do carto  invlida.","card.invalid-expiry-date":"A data de validade do carto  invlida.","card.invalid-month":"O ms de validade do carto  invlido.","card.invalid-expiry-month":"O ms de validade do carto  invlido.","card.invalid-year":"O ano de validade do carto  invlido.","card.invalid-expiry-year":"O ano de validade do carto  invlido.","card.invalid-cvc":"O cdigo de verificao do carto  invlido.","card.missing-cvc":"O cdigo de verificao do carto  obrigatrio.","card.invalid-zip":"O cdigo postal do carto  invlido.","card.failed-cvc-and-avs":"Os cdigos de verificao do carto e morada so invlidos.","card.failed-three-d-s":"A autenticao 3D-Secure falhou.","card.bad-track-data":"O carto no pode ser verificado.","card.missing-cardholder-name":"O nome do titular do carto  obrigatrio.","card.not-registered":"O carto no est registado.","card.issuer-not-found":"O emissor do carto no existe. Por favor, utilize outro carto.","card.possible-fraud":"O pagamento no foi concludo. Por favor, entre em contato com o seu banco para mais informao.","card.contact-bank":"O pagamento no foi concludo. Por favor, entre em contato com o seu banco para mais informao.","card.not-authorized":"O pagamento no foi autorizado com o carto fornecido.","card.do-not-honor":"O pagamento no foi concludo. Por favor, entre em contato com o seu banco para mais informao.","card.maximum-attempts":"O nmero de tentativas foi excedido e o pagamento no pode ser processado.","card.stolen":"O pagamento no pode ser processado sendo que o carto foi dado como roubado.","card.lost":"O pagamento no pode ser processado sendo que o carto foi dado como perdido.","card.exceeded-limits":"O pagamento no pode ser processado sendo que o limite de pagamento do carto foi excedido.","card.no-money":"A conta bancria associada ao carto possivelmente no possui fundos suficientes.","customer.canceled":"O cliente cancelou o pagamento.","customer.popup-blocked":"Por favor, ative os pop-ups para prosseguir com o pagamento.","gateway.declined":"O pagamento foi recusado.","payment.declined":"O pagamento foi recusado.","payment.pending":"O pagamento est pendente, por favor aguarde alguns minutos para ser processado.","three-d-s-2.fingerprint-timed-out":"A assinatura digital 3D-Secure expirou.","request.validation.error":"A informao fornecida est invlida ou incompleta.","request.validation.invalid-country":"O pas fornecido no  vlido.","request.validation.missing-name":"O nome  obrigatrio.","request.validation.invalid-name":"O nome fornecido no  vlido.","request.validation.missing-email":"O email  obrigatrio.","request.validation.invalid-email":"O email fornecido no  vlido.","request.validation.invalid-address":"O endereo fornecido no  vlido.","request.validation.no-method-selected":"Por favor, selecione um mtodo de pagamento.","request.gateway.not-available":"O gateway de pagamento solicitado est indisponvel.","request.gateway.not-supported":"O gateway de pagamento no  suportado.","resource.invalid-type":"O recurso fornecido  invlido. Este recurso deve ser uma fatura (invoice), assinatura (subscription) ou pedido de autorizao (authorization request).","applepay.not-supported":"O navegador / dispositivo utilizado no suporta Apple Pay."}},messages={en:{"label.cancel":"Cancel","label.apm-description":"A new window was opened to process your payment. Click here to continue."},fr:{"label.cancel":"Annuler","label.apm-description":"Une nouvelle fen&ecirc;tre s'est ouverte pour proc&eacute;der au paiement. Cliquez ici pour continuer."},es:{"label.cancel":"Cancelar","label.apm-description":"Se abri una nueva ventana para procesar su pago. Clic aqu para continuar."},pt:{"label.cancel":"Cancelar","label.apm-description":"Uma nova janela foi aberta para processar o seu pagamento. Clique aqui para continuar."}},Translator=function(){function Translator(){}return Translator.getTranslated=function(l,code,message){return l[this.getLocale()]&&l[this.getLocale()][code]?l[this.getLocale()][code]:l.en[code]?l.en[code]:message||(l[this.getLocale()]&&l[this.getLocale()]["default"]?l[this.getLocale()]["default"]:l.en["default"]?l.en["default"]:code)},Translator.translateError=function(code,message){return this.getTranslated(errors,code,message)},Translator.translateMessage=function(code,message){return this.getTranslated(messages,code,message)},Translator.getLocale=function(){var locale=navigator.language||navigator.userLanguage;return locale.length<2?"en":locale.substring(0,2).toLowerCase()},Translator}();ProcessOut.Translator=Translator}(ProcessOut=ProcessOut||{}),function(ProcessOut){var Exception=function(_super){function Exception(code,message){var _this=this;return message=message||ProcessOut.Translator.translateError(code),(_this=_super.call(this,message)||this).code=code,_this.message=message,_this.name="ProcessOutException",_this.stack=(new Error).stack,_this}return __extends(Exception,_super),Exception}(Error);ProcessOut.Exception=Exception}(ProcessOut=ProcessOut||{}),function(ProcessOut_1){ProcessOut_1.DEBUG=!1,ProcessOut_1.TestModePrefix="test-";var ProcessOut=function(){function ProcessOut(projectID,resourceID){this.timeout=1e4,this.sandbox=!1,this.host="processout.com",this.processOutFieldEndpoint="",this.processOutMessageHubEndpoint="",this.threeDSInitiationRequested=!1,this.threeDSInitiationURL="",this.apiVersion="1.3.0.0";var scripts=document.getElementsByTagName("script"),jsHost="";if(/^https?:\/\/.*\.processout\.((com)|(ninja)|(dev))\//.test(window.location.href))jsHost=window.location.href;else for(var i=0;i<scripts.length;i++)/^https?:\/\/.*\.processout\.((com)|(ninja)|(dev))\//.test(scripts[i].getAttribute("src"))&&(jsHost=scripts[i].getAttribute("src"));if(""==jsHost&&!ProcessOut_1.DEBUG)throw new ProcessOut_1.Exception("processout-js.not-hosted");if(/^https?:\/\/.*\.processout\.ninja\//.test(jsHost)?this.host="processout.ninja":/^https?:\/\/.*\.processout\.dev\//.test(jsHost)?this.host="processout.dev":this.host="processout.com",!projectID)throw new ProcessOut_1.Exception("processout-js.missing-project-id");if(this.projectID=projectID,0===this.projectID.lastIndexOf(ProcessOut_1.TestModePrefix,0)&&(this.sandbox=!0),this.resourceID=resourceID,this.resourceID&&""!=this.resourceID&&"iv_"!=this.resourceID.substring(0,3)&&"sub_"!=this.resourceID.substring(0,4)&&"auth_req_"!=this.resourceID.substring(0,9))throw new ProcessOut_1.Exception("resource.invalid-type");this.applePay=new ProcessOut_1.ApplePayWrapper(this),this.threeDS=new ProcessOut_1.ThreeDSWrapper(this)}return ProcessOut.prototype.getResourceID=function(){return this.resourceID},ProcessOut.prototype.getProjectID=function(){return this.projectID},ProcessOut.prototype.getProcessOutFieldEndpoint=function(suffix){var endpoint=this.endpoint("js","/ccfield.html");return ProcessOut_1.DEBUG&&this.processOutFieldEndpoint&&(endpoint=this.processOutFieldEndpoint),""+endpoint+suffix},ProcessOut.prototype.getProcessOutMessageHubEndpoint=function(suffix){var endpoint=this.endpoint("js","/messagehub.html");return ProcessOut_1.DEBUG&&this.processOutMessageHubEndpoint&&(endpoint=this.processOutMessageHubEndpoint),""+endpoint+suffix},ProcessOut.prototype.setProcessOutFieldEndpoint=function(endpoint){ProcessOut_1.DEBUG&&(this.processOutFieldEndpoint=endpoint)},ProcessOut.prototype.setProcessOutMessageHubEndpoint=function(endpoint){ProcessOut_1.DEBUG&&(this.processOutMessageHubEndpoint=endpoint)},ProcessOut.prototype.endpoint=function(subdomain,path){return"https://"+subdomain+"."+this.host+path},ProcessOut.prototype.apiRequest=function(method,path,data,success,error,retry,isLegacy){void 0===isLegacy&&(isLegacy=!0),retry=retry||0,method=method.toLowerCase(),"http"!=path.substring(0,4)&&"/"!=path[0]&&(path=this.endpoint("api","/"+path));var headers={"Content-Type":"application/json","API-Version":this.apiVersion};for(var k in this.projectID&&(headers.Authorization="Basic "+btoa(this.projectID+":")),(data=data||{}).idempotency_key&&(headers["Idempotency-Key"]=data.idempotency_key,delete data.idempotency_key),isLegacy&&(path+="?legacyrequest=true&project_id="+this.projectID),headers)path+="&x-"+k+"="+headers[k];if("get"==method)for(var key in data)path+="&"+key+"="+encodeURIComponent(data[key]);var request=new XMLHttpRequest;if(window.XDomainRequest&&(request=new XDomainRequest),request.open(method,path,!0),!window.XDomainRequest)for(var k in headers)request.setRequestHeader(k,headers[k]);request.timeout=0,request.onload=function(e){var parsed;try{parsed=JSON.parse(request.responseText)}catch(e){parsed={}}!window.XDomainRequest&&4!=e.currentTarget.readyState||success(parsed,request,e)},request.onerror=function(e){request.status&&200<=request.status&&request.status<500&&request.responseText?request.onload(e):error(request,e,this.getApiRequestErrorCode(request.status))}.bind(this),request.ontimeout=function(){},request.onprogress=function(){},request.onabort=function(){3<retry?error(request,null,"processout-js.aborted-retries-exceeded"):this.request(method,path,data,success,error,retry+1)}.bind(this),request.send(JSON.stringify(data))},ProcessOut.prototype.getApiRequestErrorCode=function(httpStatusCode){switch(httpStatusCode){case 0:return"processout-js.network-issue";case 501:return"processout-js.not-implemented";case 502:return"processout-js.invalid-response";case 503:return"processout-js.service-unavailable";case 504:return"processout-js.response-timeout";case 505:return"processout-js.http-version-not-supported";case 511:return"processout-js.network-auth-required";case 500:default:return"processout-js.internal-server-error"}},ProcessOut.prototype.setupForm=function(form,options,success,error){if(!this.projectID)throw new ProcessOut_1.Exception("default","You must instanciate ProcessOut.js with a valid project ID in order to use ProcessOut's hosted forms.");if(!form)throw new ProcessOut_1.Exception("default","The provided form element wasn't set. Make sure to provide setupForm with a valid form element.");return"function"==typeof options?new ProcessOut_1.CardForm(this,form).setup(new ProcessOut_1.CardFieldOptions(""),options,success):new ProcessOut_1.CardForm(this,form).setup(options,success,error)},ProcessOut.prototype.setupNativeApm=function(config){if(!this.projectID)throw new ProcessOut_1.Exception("default","You must instantiate ProcessOut.js with a valid project ID in order to use ProcessOut's Native APM");return new ProcessOut_1.NativeApm(this,config)},ProcessOut.prototype.setupDynamicCheckout=function(config){if(!this.projectID)throw new ProcessOut_1.Exception("default","You must instantiate ProcessOut.js with a valid project ID in order to use ProcessOut's Dynamic Checkout");return new ProcessOut_1.DynamicCheckout(this,config)},ProcessOut.prototype.tokenize=function(val,data,success,error){if(val instanceof ProcessOut_1.Card)return this.tokenizeCard(val,data,success,error);if(val instanceof ProcessOut_1.CardForm)return this.tokenizeForm(val,data,success,error);if(val instanceof ProcessOut_1.PaymentToken)return this.tokenizePaymentToken(val,data,success,error);if(val instanceof ProcessOut_1.ApplePay)return val.tokenize(data,success,error);throw new ProcessOut_1.Exception("processout-js.invalid-type","The first parameter had an unknown type/instance. The value must be an instance of either Card, CardForm or ApplePay.")},ProcessOut.prototype.tokenizePaymentToken=function(token,data,success,error){(data=data||{}).contact||(data.contact={}),data=this.injectDeviceData(data);var tokenType=token.getTokenType();switch(tokenType){case ProcessOut_1.TokenType.GooglePay:var payload=token.getPayload(),encodedPayload=btoa(JSON.stringify(payload));data.token_type=tokenType,data.payment_token=encodedPayload;break;default:throw new ProcessOut_1.Exception("processout-js.invalid-field","This token type is not valid or not supported yet!.")}this.apiRequest("post","cards",data,function(data,req,e){data.success?success(data.card.id,data.card):error(new ProcessOut_1.Exception(data.error_type,data.message))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.tokenizeCard=function(card,data,success,error){var err=card.validate();err?error(err):((data=data||{}).contact||(data.contact={}),(data=this.injectDeviceData(data)).number=card.getNumber(),data.exp_month=card.getExpiry().getMonth().toString(),data.exp_year=card.getExpiry().getYear().toString(),data.cvc2=card.getCVC(),this.apiRequest("post","cards",data,function(data,req,e){data.success?success(data.card.id,data.card):error(new ProcessOut_1.Exception(data.error_type,data.message))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))}))},ProcessOut.prototype.injectDeviceData=function(data){var device={request_origin:"web"};screen.colorDepth&&(device.app_color_depth=Number(screen.colorDepth));var language=navigator.language||navigator.userLanguage;return language&&(device.app_language=language),screen.height&&(device.app_screen_height=screen.height),screen.width&&(device.app_screen_width=screen.width),device.app_timezone_offset=Number((new Date).getTimezoneOffset()),window.navigator&&(device.app_java_enabled=window.navigator.javaEnabled()),data.device=device,Object.keys(device).forEach(function(key){data[key]=device[key]}),data},ProcessOut.prototype.tokenizeForm=function(form,data,success,error){form.validate(function(){form.tokenize(data,success,error)}.bind(this),error)},ProcessOut.prototype.setupFormCVC=function(form,options,success,error){return"function"==typeof options?new ProcessOut_1.CardForm(this,form).setupCVC(new ProcessOut_1.CardFieldOptions(""),options,success):new ProcessOut_1.CardForm(this,form).setupCVC(options,success,error)},ProcessOut.prototype.refreshCVC=function(cardUID,val,success,error){return val instanceof ProcessOut_1.CardForm?this.refreshCVCForm(cardUID,val,success,error):this.refreshCVCString(cardUID,val,success,error)},ProcessOut.prototype.refreshCVCForm=function(cardUID,form,success,error){form.validate(function(){form.refreshCVC(cardUID,success,error)}.bind(this),error)},ProcessOut.prototype.refreshCVCString=function(cardUID,cvc,success,error){var err=ProcessOut_1.Card.validateCVC(cvc);err?error(err):this.apiRequest("put","cards/"+cardUID,{cvc:cvc},function(data,req,e){data.success?success(data.card.id):error(new ProcessOut_1.Exception("card.invalid"))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.newModal=function(options,onReady,onError){var url="";if("object"==typeof options&&(url=options.url,onReady=options.onReady,onError=options.onError,!url&&(url=this.endpoint("checkout","/"+this.getProjectID()+"/oneoff?amount="+encodeURIComponent(options.amount)+"&currency="+encodeURIComponent(options.currency)+"&name="+encodeURIComponent(options.name)),options.metadata&&"object"==typeof options.metadata)))for(var i in options.metadata)options.metadata.hasOwnProperty(i)&&(url+="&metadata["+i+"]="+encodeURIComponent(options.metadata[i]));var uniqId=Math.random().toString(36).substr(2,9),iframe=document.createElement("iframe");iframe.className="processout-iframe",iframe.setAttribute("id","processout-iframe-"+uniqId),iframe.setAttribute("src",url),iframe.setAttribute("style","position: fixed; top: 0; left: 0; background: none; z-index: 9999999;"),iframe.setAttribute("frameborder","0"),iframe.setAttribute("allowtransparency","1"),iframe.style.display="none";var iframeError=setTimeout(function(){typeof onError==typeof Function&&onError(new ProcessOut_1.Exception("processout-js.modal.unavailable"))},this.timeout);iframe.onload=function(){clearTimeout(iframeError),typeof onReady==typeof Function&&onReady(new ProcessOut_1.Modal(this,iframe,uniqId))}.bind(this),document.body.appendChild(iframe)},ProcessOut.prototype.fetchGatewayConfigurations=function(config,success,error){if(!(config=config||{}).invoiceID&&!config.customerID!=!config.tokenID)throw new ProcessOut_1.Exception("processout-js.missing-resource-id");this.apiRequest("GET","gateway-configurations",{filter:config.filter,expand_merchant_accounts:"true"},function(data){if(data.success){for(var confs=[],_i=0,_a=data.gateway_configurations;_i<_a.length;_i++){var conf=_a[_i];conf.getInvoiceActionURL=this.buildGetInvoiceActionURL(config.invoiceID,conf),conf.handleInvoiceAction=this.buildHandleTokenInvoiceAction(config.invoiceID,conf,config.customerTokenID),conf.hookForInvoice=this.buildConfHookForInvoice(conf),conf.getCustomerTokenActionURL=this.buildGetCustomerTokenActionURL(config.customerID,config.tokenID,conf),conf.handleCustomerTokenAction=this.buildHandleCustomerTokenAction(config.customerID,config.tokenID,conf),conf.handleCustomerTokenActionAdditionalData=this.buildHandleCustomerTokenActionAdditionalData(config.customerID,config.tokenID,conf),conf.hookForCustomerToken=this.buildConfHookForCustomerToken(conf),confs.push(conf)}success(confs)}else error(new ProcessOut_1.Exception(data.error_type,data.message))}.bind(this),function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.getInvoiceActionURL=function(invoiceID,gatewayConf,additionalData){var gatewayConfigurationId=gatewayConf&&gatewayConf.id?gatewayConf.id:gatewayConf;return this.getConfigurableInvoiceActionURL({invoiceId:invoiceID,gatewayConfigurationId:gatewayConfigurationId,additionalData:additionalData})},ProcessOut.prototype.getConfigurableInvoiceActionURL=function(config){var gatewayConfID=config.gatewayConfigurationId,invoiceId=config.invoiceId;if(!invoiceId)throw new ProcessOut_1.Exception("processout-js.missing-resource-id","An Invoice Action was requested, but the Invoice ID was missing. Make sure you didn't rather want to call `customerToken` helpers on the gateway configuration instead of `invoice` ones.");var suffix="?",additionalData=config.additionalData;for(var key in additionalData)suffix+="additional_data["+key+"]="+encodeURI(additionalData[key])+"&";var tokenSuffix=config.customerTokenId?"/tokenized/"+config.customerTokenId:"",path="/"+this.getProjectID()+"/"+invoiceId+"/redirect/"+gatewayConfID+tokenSuffix+suffix.substring(0,suffix.length-1);return this.endpoint("checkout",path)},ProcessOut.prototype.handleInvoiceAction=function(invoiceID,gatewayConf,tokenized,tokenError,iframeOverride){return this.handleInvoiceActionAdditionalData(invoiceID,gatewayConf,{},tokenized,tokenError,iframeOverride)},ProcessOut.prototype.handleInvoiceActionAdditionalData=function(invoiceID,gatewayConf,additionalData,tokenized,tokenError,iframeOverride){var gatewayName=null,gatewayLogo=null;gatewayConf&&gatewayConf.id&&gatewayConf.gateway&&(gatewayName=gatewayConf.gateway.name,gatewayLogo=gatewayConf.gateway.logo_url);var options=new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo,iframeOverride);return this.handleAction(this.getInvoiceActionURL(invoiceID,gatewayConf,additionalData),tokenized,tokenError,options)},ProcessOut.prototype.handleConfigurableInvoiceAction=function(props){var sanitizedProps=ProcessOut_1.sanitizeInvoiceActionProps(props),gatewayName=sanitizedProps.gatewayConf.gatewayName,gatewayLogo=sanitizedProps.gatewayConf.gatewayLogoUrl,options=new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo,sanitizedProps.iframeOverride),urlConfig={invoiceId:sanitizedProps.invoiceId,gatewayConfigurationId:sanitizedProps.gatewayConf.id,additionalData:sanitizedProps.additionalData,customerTokenId:sanitizedProps.customerTokenId};return this.handleAction(this.getConfigurableInvoiceActionURL(urlConfig),sanitizedProps.tokenized,sanitizedProps.tokenError,options)},ProcessOut.prototype.buildGetInvoiceActionURL=function(invoiceID,gatewayConf){return function(){return this.getInvoiceActionURL(invoiceID,gatewayConf)}.bind(this)},ProcessOut.prototype.buildHandleInvoiceAction=function(invoiceID,gatewayConf){return function(tokenized,tokenError,iframeOverride){return this.handleInvoiceAction(invoiceID,gatewayConf,tokenized,tokenError,iframeOverride)}.bind(this)},ProcessOut.prototype.buildHandleTokenInvoiceAction=function(invoiceID,gatewayConf,customerTokenId){return customerTokenId?function(tokenized,tokenError,iframeOverride){return this.handleConfigurableInvoiceAction({invoiceId:invoiceID,tokenized:tokenized,tokenError:tokenError,gatewayConf:ProcessOut_1.mapInvoiceGatewayConfigurationProps(gatewayConf),customerTokenId:customerTokenId,additionalData:{},iframeOverride:iframeOverride})}.bind(this):this.buildHandleInvoiceAction(invoiceID,gatewayConf)},ProcessOut.prototype.buildConfHookForInvoice=function(gatewayConf){return function(el,tokenized,tokenError){el.addEventListener("click",function(e){return e.preventDefault(),gatewayConf.handleInvoiceAction(tokenized,tokenError),!1}.bind(this))}.bind(this)},ProcessOut.prototype.getCustomerTokenActionURL=function(customerID,tokenID,gatewayConf){var gatewayConfID=gatewayConf;if(gatewayConf&&gatewayConf.id&&(gatewayConfID=gatewayConf.id),!customerID||!tokenID)throw new ProcessOut_1.Exception("processout-js.missing-resource-id","A Customer Token Action was requested, but a customer ID or a token ID was missing. Make sure you didn't rather want to call `invoice` helpers on the gateway configuration instead of `customerToken` ones.");return this.endpoint("checkout","/"+this.getProjectID()+"/"+customerID+"/"+tokenID+"/redirect/"+gatewayConfID)},ProcessOut.prototype.getCustomerTokenActionURLAdditionalData=function(customerID,tokenID,additionalData,gatewayConf){var gatewayConfID=gatewayConf;if(gatewayConf&&gatewayConf.id&&(gatewayConfID=gatewayConf.id),!customerID||!tokenID)throw new ProcessOut_1.Exception("processout-js.missing-resource-id","A Customer Token Action was requested, but a customer ID or a token ID was missing. Make sure you didn't rather want to call `invoice` helpers on the gateway configuration instead of `customerToken` ones.");var suffix="?";for(var key in additionalData)suffix+="additional_data["+key+"]="+encodeURI(additionalData[key])+"&";return this.endpoint("checkout","/"+this.getProjectID()+"/"+customerID+"/"+tokenID+"/redirect/"+gatewayConfID+suffix.substring(0,suffix.length-1))},ProcessOut.prototype.handleCustomerTokenAction=function(customerID,tokenID,gatewayConf,tokenized,tokenError){var gatewayName=null,gatewayLogo=null;gatewayConf&&gatewayConf.id&&gatewayConf.gateway&&(gatewayName=gatewayConf.gateway.name,gatewayLogo=gatewayConf.gateway.logo_url);var options=new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo);return this.handleAction(this.getCustomerTokenActionURL(customerID,tokenID,gatewayConf),tokenized,tokenError,options)},ProcessOut.prototype.handleCustomerTokenActionAdditionalData=function(customerID,tokenID,gatewayConf,additionalData,tokenized,tokenError){var gatewayName=null,gatewayLogo=null;gatewayConf&&gatewayConf.id&&gatewayConf.gateway&&(gatewayName=gatewayConf.gateway.name,gatewayLogo=gatewayConf.gateway.logo_url);var options=new ProcessOut_1.ActionHandlerOptions(gatewayName,gatewayLogo);return this.handleAction(this.getCustomerTokenActionURLAdditionalData(customerID,tokenID,additionalData,gatewayConf),tokenized,tokenError,options)},ProcessOut.prototype.buildGetCustomerTokenActionURL=function(customerID,tokenID,gatewayConf){return function(){return this.getCustomerTokenActionURL(customerID,tokenID,gatewayConf)}.bind(this)},ProcessOut.prototype.buildHandleCustomerTokenAction=function(customerID,tokenID,gatewayConf){return function(tokenized,tokenError){return this.handleCustomerTokenAction(customerID,tokenID,gatewayConf,tokenized,tokenError)}.bind(this)},ProcessOut.prototype.buildHandleCustomerTokenActionAdditionalData=function(customerID,tokenID,gatewayConf){return function(additionalData,tokenized,tokenError){return this.handleCustomerTokenActionAdditionalData(customerID,tokenID,gatewayConf,additionalData,tokenized,tokenError)}.bind(this)},ProcessOut.prototype.buildConfHookForCustomerToken=function(gatewayConf){return function(el,tokenized,tokenError){el.addEventListener("click",function(e){return e.preventDefault(),gatewayConf.handleCustomerTokenAction(tokenized,tokenError),!1}.bind(this))}.bind(this)},ProcessOut.prototype.handleAction=function(url,success,error,options){return new ProcessOut_1.ActionHandler(this,options).handle(url,success,error)},ProcessOut.prototype.makeCardToken=function(val,customerID,customerTokenID,options,success,error){return val instanceof ProcessOut_1.Card||val instanceof ProcessOut_1.CardForm?this.tokenize(val,options,function(token){return this.makeCardTokenFromCardID(token,customerID,customerTokenID,options,success,error)}.bind(this),error):this.makeCardTokenFromCardID(val,customerID,customerTokenID,options,success,error)},ProcessOut.prototype.makeCardTokenFromCardID=function(cardID,customerID,customerTokenID,options,success,error){this.handleCardActions("PUT","customers/"+customerID+"/tokens/"+customerTokenID,customerTokenID,cardID,options,success,error)},ProcessOut.prototype.initiateThreeDS=function(invoiceID,source,options,success,error){var url="invoices/"+invoiceID+"/capture";this.threeDSInitiationURL="invoices/"+invoiceID+"/three-d-s",this.threeDSInitiationRequested=!0,this.handleCardActions("POST",url,invoiceID,source,options,success,error)},ProcessOut.prototype.makeCardPayment=function(invoiceID,cardID,options,success,error){this.handleCardActions("POST","invoices/"+invoiceID+"/capture",invoiceID,cardID,options,success,error)},ProcessOut.prototype.makeIncrementalAuthorizationPayment=function(invoiceID,cardID,options,success,error){(options=options||{}).incremental=!0,this.handleCardActions("POST","invoices/"+invoiceID+"/authorize",invoiceID,cardID,options,success,error)},ProcessOut.prototype.incrementAuthorizationAmount=function(invoiceID,amount,success,error){this.apiRequest("POST","invoices/"+invoiceID+"/increment_authorization",{amount:amount},function(data,req,e){data.success?success(data):error(new ProcessOut_1.Exception("request.validation.error"))},function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut.prototype.handleCardActions=function(method,endpoint,resourceID,cardID,options,success,error){var _this=this,getEndpoint=function(){return _this.threeDSInitiationRequested?(_this.threeDSInitiationRequested=!1,_this.threeDSInitiationURL):endpoint},source=cardID;(options=options||{}).gatewayRequestSource&&(source=options.gatewayRequestSource);var payload={authorize_only:options.authorize_only,allow_fallback_to_sale:options.allow_fallback_to_sale,capture_amount:options.capture_amount,auto_capture_at:options.auto_capture_at,source:source,enable_three_d_s_2:!0,verify:options.verify,verify_metadata:options.verify_metadata,set_default:options.set_default,incremental:options.incremental,preferred_scheme:options.preferred_scheme};payload=this.injectDeviceData(payload),options.idempotency_key&&(options.iterationNumber||(options.iterationNumber=1),payload.idempotency_key=options.idempotency_key+"-"+options.iterationNumber,options.iterationNumber++),this.apiRequest(method,getEndpoint(),payload,function(data){if(data.success)if(data.customer_action){var nextStep=function(data){options.gatewayRequestSource=data,this.handleCardActions(method,getEndpoint(),resourceID,cardID,options,success,error)}.bind(this);switch(data.customer_action.type){case"url":var opts=ProcessOut_1.ActionHandlerOptions.ThreeDSChallengeFlow;data.customer_action.metadata&&"true"===data.customer_action.metadata.no_iframe&&(opts=ProcessOut_1.ActionHandlerOptions.ThreeDSChallengeFlowNoIframe),this.handleAction(data.customer_action.value,function(data){options.gatewayRequestSource=null,this.handleCardActions(method,getEndpoint(),resourceID,cardID,options,success,error)}.bind(this),error,new ProcessOut_1.ActionHandlerOptions(opts));break;case"fingerprint":this.handleAction(data.customer_action.value,nextStep,function(err){var gReq=new ProcessOut_1.GatewayRequest;gReq.url=data.customer_action.value,gReq.method="POST",gReq.headers={"Content-Type":"application/x-www-form-urlencoded"},gReq.body='threeDSMethodData={"threeDS2FingerprintTimeout":true}',nextStep(gReq.token())},new ProcessOut_1.ActionHandlerOptions(ProcessOut_1.ActionHandlerOptions.ThreeDSFingerprintFlow));break;case"redirect":this.handleAction(data.customer_action.value,nextStep,error,new ProcessOut_1.ActionHandlerOptions(ProcessOut_1.ActionHandlerOptions.ThreeDSChallengeFlow));break;default:error(new ProcessOut_1.Exception("processout-js.wrong-type-for-action","The customer action type "+data.customer_action.type+" is not supported."))}}else success(resourceID);else error(new ProcessOut_1.Exception(data.error_type,data.message))}.bind(this),function(req,e,errorCode){error(new ProcessOut_1.Exception(errorCode))})},ProcessOut}();ProcessOut_1.ProcessOut=ProcessOut}(ProcessOut=ProcessOut||{}),function(ProcessOut){var Modal=function(){function Modal(instance,iframe,uniqId){this.deleted=!1,this.timeout=1e4,this.instance=instance,this.iframe=iframe,this.uniqId=uniqId}return Modal.prototype.show=function(options,onHide,onError){var onPayment,onPaymentError,hideAfterSuccessTimeout,onShow=options;"object"==typeof options&&(onShow=options.onShow,onHide=options.onHide,onError=options.onError,onPayment=options.onPayment,onPaymentError=options.onPaymentError,hideAfterSuccessTimeout=options.hideAfterSuccessTimeout),null==hideAfterSuccessTimeout&&(hideAfterSuccessTimeout=2500);var modal=this,iframe=modal.iframe,iframeW=iframe.contentWindow,frameid=modal.uniqId;iframeW.postMessage(JSON.stringify({namespace:ProcessOut.Message.modalNamespace,frameID:frameid,action:"check"}),"*");var redirectTimeout=setTimeout(function(){typeof onError==typeof Function&&onError(modal,new ProcessOut.Exception("processout-js.modal.unavailable"))},this.timeout);window.addEventListener("message",function(event){var data=ProcessOut.Message.parseEvent(event);if(data.frameID==frameid&&data.namespace==ProcessOut.Message.modalNamespace)switch(data.action){case"openModal":if(clearTimeout(redirectTimeout),document.body.style.overflow="hidden",window.addEventListener("resize",function(event){iframe.width=window.outerWidth+"px",iframe.height=window.outerHeight+"px"}),"function"==typeof Event)var devent=new Event("resize");else{devent=document.createEvent("Event");event.initEvent("resize",!0,!0)}window.dispatchEvent(devent),iframe.style.display="block",iframeW.postMessage(JSON.stringify({namespace:ProcessOut.Message.modalNamespace,frameID:frameid,action:"launch"}),"*"),typeof onShow==typeof Function&&onShow(modal);break;case"closeModal":modal.hide(),typeof onHide==typeof Function&&onHide(modal);break;case"error":clearTimeout(redirectTimeout),typeof onError==typeof Function&&onError(modal,new ProcessOut.Exception(data.errorCode,data.errorMessage));break;case"onPayment":typeof onPayment==typeof Function&&onPayment(modal,data.data),0<hideAfterSuccessTimeout&&setTimeout(function(){modal.hide()},hideAfterSuccessTimeout);break;case"onPaymentError":typeof onPaymentError==typeof Function&&onPaymentError(modal,new ProcessOut.Exception(data.errorCode,data.errorMessage));break;default:console.log("Could not read event action from modal.",event.data)}},!1)},Modal.prototype.hide=function(){this.iframe.style.display="none",document.body.style.overflow="",this.iframe.remove(),this.deleted=!0},Modal.prototype.isDeleted=function(){return this.deleted},Modal}();ProcessOut.Modal=Modal}(ProcessOut=ProcessOut||{}),function(ProcessOut){var MessageHub=function(){function MessageHub(instance,onready,onnotify){this.instance=instance,this.onnotify=onnotify,this.load(onready)}return MessageHub.prototype.load=function(onready){var tmp=Math.random().toString(36).substring(7),src=this.instance.getProcessOutMessageHubEndpoint("?r="+tmp);if(window.addEventListener("message",function(event){if(this.active){var data=ProcessOut.Message.parseEvent(event);data&&data.namespace==ProcessOut.Message.messageHubNamespace&&"value"==data.action&&this.onnotify&&this.onnotify(data.data.key,data.data.value)}}.bind(this)),MessageHub.iframe)onready&&onready(this);else{var ready=!1;window.addEventListener("message",function(event){if(!ready){var data=ProcessOut.Message.parseEvent(event);data&&data.namespace==ProcessOut.Message.messageHubNamespace&&"ready"==data.action&&(ready=!0,onready&&onready(this))}}.bind(this)),(MessageHub.iframe=document.createElement("iframe")).id="processout-message-hub",MessageHub.iframe.name="processout message hub",MessageHub.iframe.setAttribute("src",src),MessageHub.iframe.setAttribute("style","background: none; width: 0; height: 0"),MessageHub.iframe.setAttribute("frameborder","0"),MessageHub.iframe.setAttribute("allowtransparency","1"),document.body.appendChild(MessageHub.iframe)}this.active=!0},MessageHub.prototype.get=function(key){this.active&&MessageHub.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.messageHubNamespace,action:"get",data:{key:key}}),"*")},MessageHub.prototype.set=function(key,val){this.active&&MessageHub.iframe.contentWindow.postMessage(JSON.stringify({namespace:ProcessOut.Message.messageHubNamespace,action:"set",data:{key:key,value:val}}),"*")},MessageHub}();ProcessOut.MessageHub=MessageHub}(ProcessOut=ProcessOut||{}),function(ProcessOut){var Message=function(){function Message(){}return Message.parseEvent=function(e){try{return JSON.parse(e.data)}catch(e){return new Message}},Message.modalNamespace="processout.modal",Message.checkoutNamespace="processout.checkout",Message.fieldNamespace="processout.field",Message.messageHubNamespace="processout.message-hub",Message}();ProcessOut.Message=Message}(ProcessOut=ProcessOut||{}),function(ProcessOut){var PaymentToken=function(){function PaymentToken(tokenType,payload){this.tokenType=tokenType,this.payload=payload}return PaymentToken.prototype.getTokenType=function(){return this.tokenType},PaymentToken.prototype.getPayload=function(){return this.payload},PaymentToken}();ProcessOut.PaymentToken=PaymentToken,function(TokenType){TokenType.GooglePay="googlepay"}(ProcessOut.TokenType||(ProcessOut.TokenType={}))}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApm=function(){function NativeApm(processOutInstance,paymentConfig){this.prefilledData={},this.captureStart=null,this.processOutInstance=processOutInstance,this.paymentConfig=new ProcessOut.NativeApmPaymentConfig(paymentConfig),this.theme=new ProcessOut.NativeApmThemeConfig,this.loadMarkdownLibrary()}return NativeApm.prototype.mount=function(containerSelector){if(this.napmContainer=document.querySelector(containerSelector),!this.napmContainer)throw new ProcessOut.Exception("default","Element with this selector does not exist. You must provide valid element selector");this.loadView(new ProcessOut.NativeApmSpinner(this.theme).getSpinnerElement()),this.getGatewayConfiguration({onFetch:ProcessOut.EventsUtils.dispatchWidgetLoadingEvent,onSuccess:this.onGatewayConfigurationSuccess.bind(this),onError:this.onGatewayConfigurationError.bind(this)})},NativeApm.prototype.getGatewayConfiguration=function(actions){var paymentConfig=this.paymentConfig.getConfig();actions.onFetch(),this.processOutInstance.apiRequest("GET","invoices/"+paymentConfig.invoiceId+"/native-payment/"+paymentConfig.gatewayConfigurationId,{},actions.onSuccess.bind(this),actions.onError.bind(this))},NativeApm.prototype.onGatewayConfigurationSuccess=function(data){if(!data.success){var errorView=new ProcessOut.NativeApmErrorView({},this.theme);return ProcessOut.EventsUtils.dispatchGatewayConfigurationErrorEvent(data),this.loadView(errorView.getViewElement())}if(this.gatewayConfiguration=data,this.gatewayConfiguration.native_apm&&this.gatewayConfiguration.native_apm.parameters.length){var nativeApmFormView=new ProcessOut.NativeApmFormView(this.gatewayConfiguration.native_apm,this.proceedPayment.bind(this),this.theme,this.prefilledData);return ProcessOut.EventsUtils.dispatchWidgetReadyEvent(),this.loadView(nativeApmFormView.getViewElement())}if(this.gatewayConfiguration.native_apm&&0===this.gatewayConfiguration.native_apm.parameters.length){var pendingView=new ProcessOut.NativeApmPendingView(this.gatewayConfiguration,this.markdownLibraryInstance,this.theme,this.capturePayment.bind(this));return ProcessOut.EventsUtils.dispatchPaymentInitEvent(),this.loadView(pendingView.getViewElement())}},NativeApm.prototype.onGatewayConfigurationError=function(req,e,errorCode){var errorView=new ProcessOut.NativeApmErrorView({},this.theme),errorData=req.response;return!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.EventsUtils.dispatchGatewayConfigurationErrorEvent(errorData),this.loadView(errorView.getViewElement())},NativeApm.prototype.proceedPayment=function(paymentData,onFormSubmitFinished,onFormApiValidationError){var _this=this,paymentConfig=this.paymentConfig.getConfig();this.processOutInstance.apiRequest("POST","invoices/"+paymentConfig.invoiceId+"/native-payment",{gateway_configuration_id:paymentConfig.gatewayConfigurationId,native_apm:{parameter_values:paymentData}},function(data){return _this.handlePaymentSuccess(data,onFormSubmitFinished,onFormApiValidationError)},this.handlePaymentError.bind(this))},NativeApm.prototype.handlePaymentSuccess=function(data,onFormSubmitFinished,onFormApiValidationError){if(onFormSubmitFinished(),ProcessOut.ErrorsUtils.isFieldsValidationError(data))return onFormApiValidationError(data.invalid_fields);if(ProcessOut.ErrorsUtils.isValidationError(data)){var errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme);return ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data),this.loadView(errorView.getViewElement())}if(!data.success){errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme);return ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data),this.loadView(errorView.getViewElement())}if(data.native_apm&&"CUSTOMER_INPUT"===data.native_apm.state){var customerInputView=new ProcessOut.NativeApmFormView({gateway:this.gatewayConfiguration.native_apm.gateway,parameters:data.native_apm.parameterDefinitions,invoice:this.gatewayConfiguration.native_apm.invoice},this.proceedPayment.bind(this),this.theme,this.prefilledData);return ProcessOut.EventsUtils.dispatchPaymentAdditionalInputEvent(),this.loadView(customerInputView.getViewElement())}if(data.native_apm&&"PENDING_CAPTURE"===data.native_apm.state){this.updatePaymentProviderLogo(data.native_apm.parameterValues.provider_logo_url);var pendingView=new ProcessOut.NativeApmPendingView(this.gatewayConfiguration,this.markdownLibraryInstance,this.theme,this.capturePayment.bind(this));return ProcessOut.EventsUtils.dispatchPaymentInitEvent(),this.loadView(pendingView.getViewElement())}},NativeApm.prototype.handlePaymentError=function(req,e,errorCode){var errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme),errorData=req.response;!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.EventsUtils.dispatchPaymentErrorEvent(errorData),this.loadView(errorView.getViewElement())},NativeApm.prototype.capturePayment=function(){var paymentConfig=this.paymentConfig.getConfig();this.captureStart||(this.captureStart=new Date),this.processOutInstance.apiRequest("POST","invoices/"+paymentConfig.invoiceId+"/capture",{source:paymentConfig.gatewayConfigurationId},this.handleCaptureSuccess.bind(this),this.handleCaptureError.bind(this))},NativeApm.prototype.checkIfCaptureTimeout=function(){return 180<=((new Date).getTime()-this.captureStart.getTime())/1e3},NativeApm.prototype.handleCaptureSuccess=function(data){if(data.success&&data.native_apm&&"PENDING_CAPTURE"===data.native_apm.state&&!this.checkIfCaptureTimeout())return this.capturePayment();if(data.success&&data.native_apm&&"PENDING_CAPTURE"===data.native_apm.state&&this.checkIfCaptureTimeout())return this.captureStart=null,ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data);if(!data.success){this.captureStart=null;var errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme);return ProcessOut.EventsUtils.dispatchPaymentErrorEvent(data),this.loadView(errorView.getViewElement())}this.captureStart=null;var successView=new ProcessOut.NativeApmSuccessView(this.gatewayConfiguration,this.markdownLibraryInstance,this.theme);return ProcessOut.EventsUtils.dispatchPaymentSuccessEvent(),this.loadView(successView.getViewElement())},NativeApm.prototype.handleCaptureError=function(req,e,errorCode){var errorView=new ProcessOut.NativeApmErrorView(this.gatewayConfiguration.native_apm,this.theme),errorData=req.response;!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.EventsUtils.dispatchPaymentErrorEvent(errorData),this.loadView(errorView.getViewElement())},NativeApm.prototype.setTheme=function(themeConfig){return this.theme.setTheme(themeConfig)},NativeApm.prototype.prefillData=function(data){this.prefilledData=data},NativeApm.prototype.loadView=function(view){this.widgetWrapper&&this.napmContainer.removeChild(this.widgetWrapper),this.widgetWrapper=this.createWidgetWrapper(),this.widgetWrapper.appendChild(view),this.napmContainer.appendChild(this.widgetWrapper)},NativeApm.prototype.updatePaymentProviderLogo=function(logoUrl){logoUrl&&(this.gatewayConfiguration=__assign({},this.gatewayConfiguration,{native_apm:__assign({},this.gatewayConfiguration.native_apm,{gateway:__assign({},this.gatewayConfiguration.native_apm.gateway,{logo_url:logoUrl})})}))},NativeApm.prototype.createWidgetWrapper=function(){var widgetWrapper=document.createElement("div"),styleElement=this.theme.createInitialStyleTag();return widgetWrapper.setAttribute("class","native-apm-widget-wrapper"),widgetWrapper.appendChild(styleElement),ProcessOut.StylesUtils.styleElement(widgetWrapper,this.theme.wrapper),widgetWrapper},NativeApm.prototype.loadMarkdownLibrary=function(){var _this=this,markdownScript=document.createElement("script");markdownScript.src="https://js.processout.ninja/js/libraries/showdown.min.js",markdownScript.onload=function(){_this.markdownLibraryInstance=window.globalThis&&window.globalThis.showdown?new window.globalThis.showdown.Converter:null},document.head.appendChild(markdownScript)},NativeApm}();ProcessOut.NativeApm=NativeApm}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmPaymentConfig=function(){function NativeApmPaymentConfig(config){this.setConfig(config)}return NativeApmPaymentConfig.prototype.getConfig=function(){return{gatewayConfigurationId:this.gatewayConfigurationId,invoiceId:this.invoiceId}},NativeApmPaymentConfig.prototype.setConfig=function(config){if(!this.isValidConfig(config))throw new ProcessOut.Exception("default","You must instantiate Native APM with a valid config in order to use it");this.gatewayConfigurationId=config.gatewayConfigurationId,this.invoiceId=config.invoiceId},NativeApmPaymentConfig.prototype.isValidConfig=function(config){return config.gatewayConfigurationId&&config.invoiceId},NativeApmPaymentConfig}();ProcessOut.NativeApmPaymentConfig=NativeApmPaymentConfig}(ProcessOut=ProcessOut||{});var defaultTheme={wrapper:{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",width:"100%",fontSize:"1rem"},spinner:{width:"4rem",height:"4rem",border:"5px solid #f2f2f2",borderBottomColor:"#7e57c2",borderRadius:"50%",display:"inline-block",boxSizing:"border-box",animation:"rotation 1s linear infinite"},logo:{width:"10rem",height:"auto",marginBottom:"1rem"},buttons:{"default":{borderWidth:"0px",color:"#fff",backgroundColor:"#7e57c2",cursor:"pointer",padding:"0.8rem 1.5rem",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",marginTop:"0.8rem",fontSize:"1rem",borderRadius:"5px"},spinner:{position:"absolute",width:"1rem",height:"1rem",border:"3px solid #f2f2f2",borderBottomColor:"#7e57c2",borderRadius:"50%",display:"inline-block",boxSizing:"border-box",animation:"rotation 1s linear infinite"}},form:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:"0.8rem",width:"100%",inputsWrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-start",gap:"0.8rem",alignItems:"center",width:"100%"},inputs:{wrapper:{width:"inherit"},text:{padding:"0 0.8rem",height:"3rem",border:"1px solid #d7d7d7",borderRadius:"5px",width:"100%",fontSize:"1rem"},select:{height:"3rem",width:"100%",border:"1px solid #d7d7d7",borderRadius:"5px",fontSize:"1rem"},numeric:{display:"flex",flexDirection:"row",gap:"0.8rem",character:{width:"3rem",height:"3rem",fontSize:"1.5rem",border:"1px solid #d7d7d7",borderRadius:"5px",textAlign:"center"}}},labels:{display:"block",marginBottom:"10px",requiredStar:{color:"#e74c3c",marginLeft:"0.1rem"}},errors:{display:"block",color:"#e74c3c",fontSize:"0.9rem",minHeight:"1rem",marginTop:"0.3rem",width:"100%"}},message:{fontSize:"1.1rem"},actionImage:{marginTop:"1.3rem",width:"15rem",height:"auto"}},spinnerLoadingAnimation="\n@keyframes rotation {\n    0% {\n      transform: rotate(0deg);\n    }\n    100% {\n      transform: rotate(360deg);\n    }\n  }\n";!function(ProcessOut){var NativeApmThemeConfig=function(){function NativeApmThemeConfig(){this.wrapper=defaultTheme.wrapper,this.spinner=defaultTheme.spinner,this.logo=defaultTheme.logo,this.buttons=defaultTheme.buttons,this.form=defaultTheme.form,this.message=defaultTheme.message,this.actionImage=defaultTheme.actionImage}return NativeApmThemeConfig.prototype.getTheme=function(){return{wrapper:this.wrapper,spinner:this.spinner,logo:this.logo,buttons:this.buttons,form:this.form,message:this.message,actionImage:this.actionImage}},NativeApmThemeConfig.prototype.setTheme=function(theme){var mergeObjects=function(obj1,obj2){for(var key in obj2)obj2.hasOwnProperty(key)&&("object"==typeof obj2[key]&&null!==obj2[key]?obj1[key]=mergeObjects(obj1[key],obj2[key]):obj1[key]=obj2[key]);return obj1};mergeObjects(this.wrapper,theme.wrapper),mergeObjects(this.spinner,theme.spinner),mergeObjects(this.logo,theme.logo),mergeObjects(this.buttons,theme.buttons),mergeObjects(this.form,theme.form),mergeObjects(this.message,theme.message),mergeObjects(this.actionImage,theme.actionImage)},NativeApmThemeConfig.prototype.createInitialStyleTag=function(){var styleElement=document.createElement("style");return styleElement.innerHTML=spinnerLoadingAnimation,styleElement},NativeApmThemeConfig}();ProcessOut.NativeApmThemeConfig=NativeApmThemeConfig}(ProcessOut=ProcessOut||{}),function(ProcessOut){var StylesUtils=function(){function StylesUtils(){}return StylesUtils.styleElement=function(node,styles){return Object.keys(styles).forEach(function(style){node.style[style]=styles[style]})},StylesUtils}();ProcessOut.StylesUtils=StylesUtils}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NATIVE_APM_EVENTS_WIDGET_LOADING="processout_native_apm_loading",NATIVE_APM_EVENTS_WIDGET_READY="processout_native_apm_ready",NATIVE_APM_EVENTS_GATEWAY_CONFIGURATION_ERROR="processout_native_apm_gateway_configuration_error",NATIVE_APM_EVENTS_PAYMENT_INIT="processout_native_apm_payment_init",NATIVE_APM_EVENTS_PAYMENT_ADDITIONAL_INPUT="processout_native_apm_payment_additional_input",NATIVE_APM_EVENTS_PAYMENT_SUCCESS="processout_native_apm_payment_success",NATIVE_APM_EVENTS_PAYMENT_ERROR="processout_native_apm_payment_error",EventsUtils=function(){function EventsUtils(){}return EventsUtils.dispatchGatewayConfigurationErrorEvent=function(errorData){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_GATEWAY_CONFIGURATION_ERROR,errorData);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentInitEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_INIT);return window.dispatchEvent(event)},EventsUtils.dispatchWidgetLoadingEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_WIDGET_LOADING);return window.dispatchEvent(event)},EventsUtils.dispatchWidgetReadyEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_WIDGET_READY);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentAdditionalInputEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_ADDITIONAL_INPUT);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentSuccessEvent=function(){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_SUCCESS);return window.dispatchEvent(event)},EventsUtils.dispatchPaymentErrorEvent=function(errorData){var event=EventsUtils.createEvent(NATIVE_APM_EVENTS_PAYMENT_ERROR,errorData);return window.dispatchEvent(event)},EventsUtils.createEvent=function(eventName,data){if("function"==typeof window.CustomEvent)return new CustomEvent(eventName,{bubbles:!0,detail:data});var event_1=document.createEvent("CustomEvent");return event_1.initCustomEvent(eventName,!0,!1,data),event_1},EventsUtils}();ProcessOut.EventsUtils=EventsUtils}(ProcessOut=ProcessOut||{}),function(ProcessOut){ProcessOut.texts={en:{invalidCode:"Code is not valid.",invalidPhoneNumber:"Phone number is not valid.",invalidTextValue:"Value is not valid.",invalidEmail:"Email is not valid.",phoneNumberPlaceholder:"Enter phone number",phoneNumberLabel:"Phone number",emailPlaceholder:"name@exmple.com",submitButtonText:"Pay",paymentSuccessMessage:"Success!\nPayment approved.",genericError:"Something went wrong, please try again.",paymentTimeout:"The payment was not confirmed in time in the banking application. Please try again."},pl:{invalidCode:"Niepoprawny kod.",invalidPhoneNumber:"Niepoprawny numer telefonu.",invalidTextValue:"Niepoprawna warto.",invalidEmail:"Niepoprawny adres email.",phoneNumberPlaceholder:"Twj numer telefonu",phoneNumberLabel:"Numer telefonu",emailPlaceholder:"imi@przykad.pl",submitButtonText:"Zapa",paymentSuccessMessage:"Sukces!\nPatno przyjta.",genericError:"Co poszo nie tak, sprbuj ponownie.",paymentTimeout:"Patno odrzucona. Czas na potwierdzenie transakcji zosta przekroczony. Sprbuj ponownie."},pt:{invalidCode:"Nmero invlido.",invalidPhoneNumber:"Nmero de telemvel invlido.",invalidTextValue:"Texto invlido.",invalidEmail:"Endereo de e-mail invlido.",phoneNumberPlaceholder:"Insira o seu nmero de telemvel",phoneNumberLabel:"N de telemvel",emailPlaceholder:"nome@exemplo.pt",submitButtonText:"Pagar",paymentSuccessMessage:"Successo!\nPagamento aprovado.",genericError:"Ocorreu um erro ao processar o seu carto, por favor tente novamente.",paymentTimeout:"O pagamento no foi confirmado a tempo no aplicativo bancrio. Por favor, tente novamente."},fr:{invalidCode:"Numro invalide.",invalidPhoneNumber:"Votre numro de tlphone est invalide.",invalidTextValue:"Valeur invalide.",invalidEmail:"Votre adresse e-mail est invalide.",phoneNumberPlaceholder:"Entrez votre numro de tlphone",phoneNumberLabel:"Numro de tlphone",emailPlaceholder:"nom@exemple.fr",submitButtonText:"Payer",paymentSuccessMessage:"Succs!\nPaiement confirm.",genericError:"Une erreur sest produite, veuillez ressayer.",paymentTimeout:"Le paiement n'a pas t confirm  temps dans l'application bancaire. Veuillez ressayer."}};var TextUtils=function(){function TextUtils(){}return TextUtils.getText=function(key){var locale=ProcessOut.Translator.getLocale(),supportedLocale=ProcessOut.texts.hasOwnProperty(locale)?locale:"en";return ProcessOut.texts[supportedLocale][key]||""},TextUtils}();ProcessOut.TextUtils=TextUtils}(ProcessOut=ProcessOut||{}),function(ProcessOut){var ErrorsUtils=function(){function ErrorsUtils(){}return ErrorsUtils.isFieldsValidationError=function(errorData){var error_type=errorData.error_type,invalid_fields=errorData.invalid_fields;return("request.validation.error"===error_type||"gateway.invalid-customer-input"===error_type)&&0<invalid_fields.length},ErrorsUtils.isValidationError=function(errorData){var error_type=errorData.error_type,invalid_fields=errorData.invalid_fields;return("request.validation.error"===error_type||"gateway.invalid-customer-input"===error_type)&&0===invalid_fields.length},ErrorsUtils}();ProcessOut.ErrorsUtils=ErrorsUtils}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmButton=function(){function NativeApmButton(text,theme){this.loadingSpinnerID="button-loading-spinner",this.theme=theme,this.buttonElement=this.createButtonElement(text)}return NativeApmButton.prototype.getButtonElement=function(){return this.buttonElement},NativeApmButton.prototype.createButtonElement=function(text){var buttonElement=document.createElement("button");return buttonElement.setAttribute("type","submit"),buttonElement.setAttribute("class","native-apm-button"),this.buttonText=document.createElement("span"),this.buttonText.textContent=text,ProcessOut.StylesUtils.styleElement(buttonElement,this.theme.buttons["default"]),buttonElement.appendChild(this.buttonText),buttonElement},NativeApmButton.prototype.setLoadingState=function(){var spinner=this.createLoadingSpinner();ProcessOut.StylesUtils.styleElement(this.buttonText,{opacity:"0"}),this.buttonElement.appendChild(spinner)},NativeApmButton.prototype.resetLoadingState=function(){ProcessOut.StylesUtils.styleElement(this.buttonText,{opacity:"1"}),this.removeLoadingSpinner()},NativeApmButton.prototype.createLoadingSpinner=function(){var spinner=new ProcessOut.NativeApmSpinner(this.theme,this.loadingSpinnerID).getSpinnerElement();return ProcessOut.StylesUtils.styleElement(spinner,this.theme.buttons.spinner),spinner},NativeApmButton.prototype.removeLoadingSpinner=function(){var spinner=document.getElementById(this.loadingSpinnerID);spinner&&this.buttonElement.removeChild(spinner)},NativeApmButton}();ProcessOut.NativeApmButton=NativeApmButton}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmSpinner=function(){function NativeApmSpinner(theme,id){this.theme=theme,this.spinnerElement=this.createSpinnerElement(id)}return NativeApmSpinner.prototype.getSpinnerElement=function(){return this.spinnerElement},NativeApmSpinner.prototype.createSpinnerElement=function(id){var spinnerElement=document.createElement("span");return spinnerElement.setAttribute("class","native-apm-spinner"),id&&spinnerElement.setAttribute("id",id),ProcessOut.StylesUtils.styleElement(spinnerElement,this.theme.spinner),spinnerElement},NativeApmSpinner}();ProcessOut.NativeApmSpinner=NativeApmSpinner}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmTextInput=function(){function NativeApmTextInput(inputData,theme,prefilledValue){this.theme=theme,this.inputData=inputData,this.inputElement=this.createInputElement(prefilledValue),this.inputLabel=this.createInputLabel(),this.errorMessageElement=this.createErrorMessageElement()}return NativeApmTextInput.prototype.getInputElement=function(){var inputWrapper=document.createElement("div");return inputWrapper.setAttribute("class","native-apm-text-input-wrapper"),ProcessOut.StylesUtils.styleElement(inputWrapper,this.theme.form.inputs.wrapper),inputWrapper.appendChild(this.inputLabel),inputWrapper.appendChild(this.inputElement),inputWrapper.appendChild(this.errorMessageElement),inputWrapper},NativeApmTextInput.prototype.validate=function(){var isRequiredPassed=!this.inputData.required||0<this.inputElement.value.length,maxLengthPassed=!this.inputData.max_length||this.inputElement.value.length<=this.inputData.max_length,lengthPassed=!this.inputData.length||this.inputElement.value.length===this.inputData.length;return isRequiredPassed&&maxLengthPassed&&lengthPassed||this.setErrorMessage(),isRequiredPassed&&maxLengthPassed&&lengthPassed},NativeApmTextInput.prototype.getValue=function(){var _a;return(_a={})[this.inputData.key]=this.inputElement.value,_a},NativeApmTextInput.prototype.getRawInputElement=function(){return this.inputElement},NativeApmTextInput.prototype.createInputElement=function(prefilledValue){var input=document.createElement("input");return input.setAttribute("class","native-apm-text-input"),input.setAttribute("name",this.inputData.key),input.setAttribute("id",this.inputData.key),prefilledValue&&(input.value=prefilledValue),input.addEventListener("keypress",this.resetErrorMessage.bind(this)),ProcessOut.StylesUtils.styleElement(input,this.theme.form.inputs.text),input},NativeApmTextInput.prototype.createErrorMessageElement=function(){var errorMessageElement=document.createElement("span");return errorMessageElement.setAttribute("class","native-apm-input-error"),ProcessOut.StylesUtils.styleElement(errorMessageElement,this.theme.form.errors),errorMessageElement},NativeApmTextInput.prototype.createInputLabel=function(){var label=document.createElement("label");if(label.setAttribute("class","native-apm-input-label"),label.setAttribute("for",this.inputData.key),label.textContent=this.inputData.display_name,this.inputData.required){var requiredStar=this.createRequiredStar();label.appendChild(requiredStar)}return ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmTextInput.prototype.createRequiredStar=function(){var requiredStar=document.createElement("span");return requiredStar.textContent="*",ProcessOut.StylesUtils.styleElement(requiredStar,this.theme.form.labels.requiredStar),requiredStar},NativeApmTextInput.prototype.resetErrorMessage=function(){this.errorMessageElement.textContent.length&&(this.errorMessageElement.textContent="")},NativeApmTextInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidTextValue")},NativeApmTextInput.prototype.getInputData=function(){return this.inputData},NativeApmTextInput}();ProcessOut.NativeApmTextInput=NativeApmTextInput}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmNumericInput=function(){function NativeApmNumericInput(inputData,theme){this.theme=theme,this.inputData=inputData,this.inputElement=this.createInputElement(),this.errorMessageElement=this.createErrorMessageElement(),this.inputLabel=this.createInputLabel()}return NativeApmNumericInput.prototype.getInputElement=function(){var inputWrapper=document.createElement("div");return inputWrapper.setAttribute("class","native-apm-numeric-input-wrapper"),ProcessOut.StylesUtils.styleElement(inputWrapper,this.theme.form.inputs.wrapper),inputWrapper.appendChild(this.inputLabel),inputWrapper.appendChild(this.inputElement),inputWrapper.appendChild(this.errorMessageElement),inputWrapper},NativeApmNumericInput.prototype.createInputElement=function(){for(var input=document.createElement("div"),i=0;i<this.inputData.length;i++){var inputDigit=this.createInputDigitElement();input.appendChild(inputDigit)}return input.setAttribute("class","native-apm-numeric-input"),ProcessOut.StylesUtils.styleElement(input,this.theme.form.inputs.numeric),input},NativeApmNumericInput.prototype.createInputDigitElement=function(){var _this=this,inputDigit=document.createElement("input");inputDigit.setAttribute("class","native-apm-numeric-input-character"),inputDigit.setAttribute("type","text"),inputDigit.setAttribute("maxlength","1"),inputDigit.setAttribute("id",this.inputData.key);return inputDigit.addEventListener("input",function(e){_this.resetErrorMessage();var inputElement=e.target;inputElement.value=inputElement.value.replace(/[^0-9]/g,""),""!==inputElement.value&&inputElement.nextElementSibling&&"INPUT"===inputElement.nextElementSibling.nodeName&&inputElement.nextElementSibling.focus()}),inputDigit.addEventListener("keydown",function(e){"Backspace"===e.key&&e.target instanceof HTMLInputElement&&e.target.previousElementSibling&&""===e.target.value&&e.target.previousElementSibling.focus()}),ProcessOut.StylesUtils.styleElement(inputDigit,this.theme.form.inputs.numeric.character),inputDigit},NativeApmNumericInput.prototype.createErrorMessageElement=function(){var errorMessageElement=document.createElement("span");return errorMessageElement.setAttribute("class","native-apm-input-error"),ProcessOut.StylesUtils.styleElement(errorMessageElement,this.theme.form.errors),errorMessageElement},NativeApmNumericInput.prototype.createInputLabel=function(){var label=document.createElement("label");if(label.textContent=this.inputData.display_name,label.setAttribute("class","native-apm-input-label"),label.setAttribute("for",this.inputData.key),this.inputData.required){var requiredStar=this.createRequiredStar();label.appendChild(requiredStar)}return ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmNumericInput.prototype.createRequiredStar=function(){var requiredStar=document.createElement("span");return requiredStar.textContent="*",ProcessOut.StylesUtils.styleElement(requiredStar,this.theme.form.labels.requiredStar),requiredStar},NativeApmNumericInput.prototype.validate=function(){var isValid=Array.prototype.slice.call(this.inputElement.childNodes).every(function(input){return input.value.length});return isValid||this.setErrorMessage(),isValid},NativeApmNumericInput.prototype.getValue=function(){var _a,value=Array.prototype.slice.call(this.inputElement.childNodes).reduce(function(acc,input){return acc+input.value},"");return(_a={})[this.inputData.key]=value,_a},NativeApmNumericInput.prototype.resetErrorMessage=function(){this.errorMessageElement.textContent.length&&(this.errorMessageElement.textContent="")},NativeApmNumericInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidCode")},NativeApmNumericInput}();ProcessOut.NativeApmNumericInput=NativeApmNumericInput}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmEmailInput=function(_super){function NativeApmEmailInput(inputData,theme,prefilledValue){var _this=_super.call(this,inputData,theme,prefilledValue)||this;_this.emailRegex=/^\S+@\S+$/i;var rawInputElement=_super.prototype.getRawInputElement.call(_this);return rawInputElement.setAttribute("placeholder",ProcessOut.TextUtils.getText("emailPlaceholder")),rawInputElement.setAttribute("type","email"),_this}return __extends(NativeApmEmailInput,_super),NativeApmEmailInput.prototype.validate=function(){var isRequiredPassed=_super.prototype.validate.call(this),isEmail=this.emailRegex.test(this.inputElement.value);return isEmail||this.setErrorMessage(),isRequiredPassed&&isEmail},NativeApmEmailInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidEmail")},NativeApmEmailInput}(ProcessOut.NativeApmTextInput);ProcessOut.NativeApmEmailInput=NativeApmEmailInput}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmPhoneInput=function(_super){function NativeApmPhoneInput(inputData,theme,prefilledValue){var _this=_super.call(this,inputData,theme,prefilledValue)||this;return _this.phoneNumberRegex=/^\+[1-9][0-9]{10,14}$/,_super.prototype.getRawInputElement.call(_this).setAttribute("placeholder",ProcessOut.TextUtils.getText("phoneNumberPlaceholder")),_this.inputLabel=_this.createInputLabel(),_this}return __extends(NativeApmPhoneInput,_super),NativeApmPhoneInput.prototype.getValue=function(){var _a;return(_a={})[this.inputData.key]=this.inputElement.value.replace(/\s/g,""),_a},NativeApmPhoneInput.prototype.createInputLabel=function(){var label=document.createElement("label");if(label.setAttribute("class","native-apm-input-label"),label.textContent=ProcessOut.TextUtils.getText("phoneNumberLabel"),this.inputData.required){var requiredStar=_super.prototype.createRequiredStar.call(this);label.appendChild(requiredStar)}return ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmPhoneInput.prototype.validate=function(){var isRequiredPassed=_super.prototype.validate.call(this),valueWithoutSpaces=this.inputElement.value.replace(/\s/g,""),isPhone=this.phoneNumberRegex.test(valueWithoutSpaces);return isPhone||this.setErrorMessage(),isRequiredPassed&&isPhone},NativeApmPhoneInput.prototype.setErrorMessage=function(message){this.errorMessageElement.textContent=message||ProcessOut.TextUtils.getText("invalidPhoneNumber")},NativeApmPhoneInput}(ProcessOut.NativeApmTextInput);ProcessOut.NativeApmPhoneInput=NativeApmPhoneInput}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmSelectInput=function(){function NativeApmSelectInput(inputData,theme){this.theme=theme,this.inputData=inputData,this.inputElement=this.createInputElement(),this.inputLabel=this.createInputLabel(),this.errorMessageElement=this.createErrorMessageElement()}return NativeApmSelectInput.prototype.getInputElement=function(){var inputWrapper=document.createElement("div");return ProcessOut.StylesUtils.styleElement(inputWrapper,this.theme.form.inputs.wrapper),inputWrapper.appendChild(this.inputLabel),inputWrapper.appendChild(this.inputElement),inputWrapper.appendChild(this.errorMessageElement),inputWrapper},NativeApmSelectInput.prototype.validate=function(){return!0},NativeApmSelectInput.prototype.getValue=function(){var _a;return(_a={})[this.inputData.key]=this.inputElement.value,_a},NativeApmSelectInput.prototype.getRawInputElement=function(){return this.inputElement},NativeApmSelectInput.prototype.createInputElement=function(){var _this=this,input=document.createElement("select");return input.setAttribute("class","native-apm-select-input"),input.setAttribute("name",this.inputData.key),this.inputData.available_values.forEach(function(value){var optionElement=_this.createOptionElement(value);input.appendChild(optionElement),value["default"]&&input.setAttribute("selected","true")}),ProcessOut.StylesUtils.styleElement(input,this.theme.form.inputs.select),input},NativeApmSelectInput.prototype.createOptionElement=function(value){var optionElement=document.createElement("option");return optionElement.setAttribute("value",value.value),optionElement.textContent=value.display_name,optionElement},NativeApmSelectInput.prototype.createInputLabel=function(){var label=document.createElement("label");return label.textContent=this.inputData.display_name,label.setAttribute("class","native-apm-input-label"),ProcessOut.StylesUtils.styleElement(label,this.theme.form.labels),label},NativeApmSelectInput.prototype.createErrorMessageElement=function(){var errorMessageElement=document.createElement("span");return errorMessageElement.setAttribute("class","native-apm-input-error"),ProcessOut.StylesUtils.styleElement(errorMessageElement,this.theme.form.errors),errorMessageElement},NativeApmSelectInput.prototype.setErrorMessage=function(){this.errorMessageElement.textContent=ProcessOut.TextUtils.getText("invalidTextValue")},NativeApmSelectInput}();ProcessOut.NativeApmSelectInput=NativeApmSelectInput}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmInput=function(){function NativeApmInput(inputData,theme,prefilledValue){this.inputInstance=this.createInputElement(inputData,theme,prefilledValue)}return NativeApmInput.prototype.getInputElement=function(){return this.inputInstance.getInputElement()},NativeApmInput.prototype.getInputInstance=function(){return this.inputInstance},NativeApmInput.prototype.getInputValue=function(){return this.inputInstance.getValue()},NativeApmInput.prototype.createInputElement=function(inputData,theme,prefilledValue){switch(inputData.type){case"email":return new ProcessOut.NativeApmEmailInput(inputData,theme,prefilledValue);case"numeric":return inputData.length<=6?new ProcessOut.NativeApmNumericInput(inputData,theme):new ProcessOut.NativeApmTextInput(inputData,theme,prefilledValue);case"phone":return new ProcessOut.NativeApmPhoneInput(inputData,theme,prefilledValue);case"single_select":case"single-select":return new ProcessOut.NativeApmSelectInput(inputData,theme);default:return new ProcessOut.NativeApmTextInput(inputData,theme,prefilledValue)}},NativeApmInput}();ProcessOut.NativeApmInput=NativeApmInput}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmFormView=function(){function NativeApmFormView(formData,onSubmitHandler,theme,prefilledData){if(!formData)throw new ProcessOut.Exception("default","Form data is not defined. You must provide valid form data to create the form view.");this.theme=theme,this.prefilledData=prefilledData,this.formData=formData,this.onSubmitHandler=onSubmitHandler,this.formInputs=this.createFormInputs(),this.submitButton=this.createSubmitButton(),this.formElement=this.createFormElement()}return NativeApmFormView.prototype.getViewElement=function(){return this.formElement},NativeApmFormView.prototype.createFormElement=function(){var form=document.createElement("form"),inputsWrapper=document.createElement("div"),paymentProviderImage=this.createPaymentProviderImage();return form.setAttribute("class","native-apm-form"),inputsWrapper.setAttribute("class","native-apm-form-inputs-wrapper"),ProcessOut.StylesUtils.styleElement(form,this.theme.form),this.styleInputsWrapper(inputsWrapper),this.formInputs.forEach(function(input){inputsWrapper.appendChild(input.getInputElement())}),form.appendChild(paymentProviderImage),form.appendChild(inputsWrapper),form.appendChild(this.submitButton.getButtonElement()),form.addEventListener("submit",this.submitForm.bind(this)),form},NativeApmFormView.prototype.createFormInputs=function(){var _this=this;return this.formData.parameters.map(function(parameter){var prefilledValue=_this.prefilledData[parameter.key];return new ProcessOut.NativeApmInput(parameter,_this.theme,prefilledValue)})},NativeApmFormView.prototype.createSubmitButton=function(){var buttonText="\n      "+ProcessOut.TextUtils.getText("submitButtonText")+" \n      "+this.formData.invoice.amount+" \n      "+this.formData.invoice.currency_code+"\n      ";return new ProcessOut.NativeApmButton(buttonText,this.theme)},NativeApmFormView.prototype.createPaymentProviderImage=function(){var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.formData.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmFormView.prototype.submitForm=function(event){var _this=this;if(event.preventDefault(),this.formInputs.every(function(input){return input.getInputInstance().validate()})){var values=this.getValuesFromInputs();this.submitButton.setLoadingState(),this.onSubmitHandler(values,function(){return _this.submitButton.resetLoadingState()},function(invalid_fields){return _this.handleApiValidationErrors(invalid_fields)})}},NativeApmFormView.prototype.handleApiValidationErrors=function(invalid_fields){var _this=this;return invalid_fields.forEach(function(invalidField){return _this.markInputAsNotValid(invalidField)})},NativeApmFormView.prototype.markInputAsNotValid=function(invalidInputData){this.formInputs.forEach(function(input){input.getInputInstance().inputData.key===invalidInputData.name&&input.getInputInstance().setErrorMessage()})},NativeApmFormView.prototype.getValuesFromInputs=function(){return this.formInputs.reduce(function(acc,input){return __assign({},acc,input.getInputValue())},{})},NativeApmFormView.prototype.styleInputsWrapper=function(inputsWrapper){1===this.formInputs.length&&"numeric"===this.formInputs[0].getInputInstance().inputData.type?ProcessOut.StylesUtils.styleElement(inputsWrapper,__assign({},this.theme.form.inputsWrapper,{width:"auto"})):ProcessOut.StylesUtils.styleElement(inputsWrapper,this.theme.form.inputsWrapper)},NativeApmFormView}();ProcessOut.NativeApmFormView=NativeApmFormView}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmPendingView=function(){function NativeApmPendingView(gatewayConfiguration,markdownLibraryInstance,theme,capturePayment){if(!gatewayConfiguration)throw new ProcessOut.Exception("default","Gateway configuration is not defined. You must provide valid gateway configuration");this.markdownLibraryInstance=markdownLibraryInstance,this.gatewayConfiguration=gatewayConfiguration,this.theme=theme,this.viewElement=this.createViewElement(),capturePayment()}return NativeApmPendingView.prototype.getViewElement=function(){return this.viewElement},NativeApmPendingView.prototype.createViewElement=function(){var wrapper=this.createWrapper(),merchantImg=this.createMerchantImageElement(),customerMessage=this.createCustomerMessage(),customerMessageImage=this.createCustomerMessageImage(),loadingSpinner=this.createLoadingSpinner();return wrapper.appendChild(merchantImg),wrapper.appendChild(customerMessage),wrapper.appendChild(loadingSpinner),wrapper.appendChild(customerMessageImage),wrapper},NativeApmPendingView.prototype.createMerchantImageElement=function(){var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.gatewayConfiguration.native_apm.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmPendingView.prototype.createWrapper=function(){var wrapper=document.createElement("div");return wrapper.setAttribute("class","native-apm-view-wrapper"),ProcessOut.StylesUtils.styleElement(wrapper,this.theme.wrapper),wrapper},NativeApmPendingView.prototype.createCustomerMessage=function(){var customerMessage=document.createElement("p");return customerMessage.setAttribute("class","native-apm-message"),ProcessOut.StylesUtils.styleElement(customerMessage,this.theme.message),customerMessage.innerHTML=this.markdownLibraryInstance&&this.markdownLibraryInstance.makeHtml?this.markdownLibraryInstance.makeHtml(this.gatewayConfiguration.native_apm.gateway.customer_action_message):this.gatewayConfiguration.native_apm.gateway.customer_action_message,customerMessage},NativeApmPendingView.prototype.createLoadingSpinner=function(){var spinner=new ProcessOut.NativeApmSpinner(this.theme).getSpinnerElement();return ProcessOut.StylesUtils.styleElement(spinner,this.theme.spinner),spinner},NativeApmPendingView.prototype.createCustomerMessageImage=function(){var customerMessageImage=document.createElement("img");return ProcessOut.StylesUtils.styleElement(customerMessageImage,this.theme.actionImage),customerMessageImage.setAttribute("class","native-apm-action-image"),customerMessageImage.setAttribute("src",this.gatewayConfiguration.native_apm.gateway.customer_action_image_url),customerMessageImage},NativeApmPendingView}();ProcessOut.NativeApmPendingView=NativeApmPendingView}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmErrorView=function(){function NativeApmErrorView(errorData,theme){if(!errorData)throw new ProcessOut.Exception("default","Error data is not defined. You must provide valid error data");this.errorData=errorData,this.theme=theme,this.viewElement=this.createViewElement()}return NativeApmErrorView.prototype.getViewElement=function(){return this.viewElement},NativeApmErrorView.prototype.createViewElement=function(){var wrapper=this.createWrapper(),merchantImg=this.createMerchantImageElement(),customerMessage=this.createCustomerMessage();return merchantImg&&wrapper.appendChild(merchantImg),wrapper.appendChild(customerMessage),wrapper},NativeApmErrorView.prototype.createWrapper=function(){var wrapper=document.createElement("div");return wrapper.setAttribute("class","native-apm-view-wrapper"),ProcessOut.StylesUtils.styleElement(wrapper,this.theme.wrapper),wrapper},NativeApmErrorView.prototype.createMerchantImageElement=function(){if(!this.errorData.gateway)return null;var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.errorData.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmErrorView.prototype.createCustomerMessage=function(){var customerMessage=document.createElement("p");return customerMessage.setAttribute("class","native-apm-message"),ProcessOut.StylesUtils.styleElement(customerMessage,this.theme.message),customerMessage.textContent=this.errorData.errorMessage||ProcessOut.TextUtils.getText("genericError"),customerMessage},NativeApmErrorView}();ProcessOut.NativeApmErrorView=NativeApmErrorView}(ProcessOut=ProcessOut||{}),function(ProcessOut){var NativeApmSuccessView=function(){function NativeApmSuccessView(gatewayConfiguration,markdownLibraryInstance,theme){if(!gatewayConfiguration)throw new ProcessOut.Exception("default","Gateway configuration is not defined. You must provide valid gateway configuration");this.markdownLibraryInstance=markdownLibraryInstance,this.gatewayConfiguration=gatewayConfiguration,this.theme=theme,this.viewElement=this.createViewElement()}return NativeApmSuccessView.prototype.getViewElement=function(){return this.viewElement},NativeApmSuccessView.prototype.createViewElement=function(){var wrapper=this.createWrapper(),merchantImg=this.createMerchantImageElement(),customerMessage=this.createCustomerMessage(),paymentSuccessStatus=this.createPaymentSuccessStatusImage();return wrapper.appendChild(merchantImg),wrapper.appendChild(customerMessage),wrapper.appendChild(paymentSuccessStatus),wrapper},NativeApmSuccessView.prototype.createWrapper=function(){var wrapper=document.createElement("div");return wrapper.setAttribute("class","native-apm-view-wrapper"),ProcessOut.StylesUtils.styleElement(wrapper,this.theme.wrapper),wrapper},NativeApmSuccessView.prototype.createMerchantImageElement=function(){var merchantImg=document.createElement("img");return merchantImg.setAttribute("class","native-apm-payment-provider-logo"),merchantImg.setAttribute("src",this.gatewayConfiguration.native_apm.gateway.logo_url),ProcessOut.StylesUtils.styleElement(merchantImg,this.theme.logo),merchantImg},NativeApmSuccessView.prototype.createCustomerMessage=function(){var customerMessage=document.createElement("p");return customerMessage.setAttribute("class","native-apm-message"),ProcessOut.StylesUtils.styleElement(customerMessage,this.theme.message),customerMessage.innerHTML=this.markdownLibraryInstance&&this.markdownLibraryInstance.makeHtml?this.markdownLibraryInstance.makeHtml(ProcessOut.TextUtils.getText("paymentSuccessMessage")):ProcessOut.TextUtils.getText("paymentSuccessMessage"),customerMessage},NativeApmSuccessView.prototype.createPaymentSuccessStatusImage=function(){var paymentSuccessStatusImage=document.createElement("img");return ProcessOut.StylesUtils.styleElement(paymentSuccessStatusImage,this.theme.actionImage),paymentSuccessStatusImage.setAttribute("class","native-apm-action-image"),paymentSuccessStatusImage.setAttribute("src","https://js.processout.com/images/native-apm-assets/payment_success_image.svg"),paymentSuccessStatusImage},NativeApmSuccessView}();ProcessOut.NativeApmSuccessView=NativeApmSuccessView}(ProcessOut=ProcessOut||{}),function(ProcessOut){ProcessOut.mapInvoiceGatewayConfigurationProps=function mapInvoiceGatewayConfigurationProps(gatewayConf){if(!gatewayConf)return null;var gatewayConfigurationId=gatewayConf&&gatewayConf.id?gatewayConf.id:gatewayConf;if(!gatewayConf.gateway)return{id:gatewayConfigurationId};var gateway=gatewayConf.gateway;return{id:gatewayConfigurationId,gatewayName:gateway.name,gatewayLogoUrl:gateway.logo_url}},ProcessOut.sanitizeInvoiceActionProps=function sanitizeInvoiceActionProps(props){return{invoiceId:props.invoiceId,gatewayConf:function sanitizeGatewayConfigurationProps(props){return props||{id:null}}(props.gatewayConf),customerTokenId:props.customerTokenId,additionalData:props.additionalData,tokenized:props.tokenized,tokenError:props.tokenError,iframeOverride:props.iframeOverride}}}(ProcessOut=ProcessOut||{}),function(ProcessOut){var DynamicCheckout=function(){function DynamicCheckout(processOutInstance,paymentConfig){this.processOutInstance=processOutInstance,this.paymentConfig=new ProcessOut.DynamicCheckoutConfig(paymentConfig)}return DynamicCheckout.prototype.getInvoiceDetails=function(actions){this.processOutInstance.apiRequest("GET","invoices/"+this.paymentConfig.invoiceId+"?expand=transaction",{},actions.onSuccess.bind(this),actions.onError.bind(this),0,!1)},DynamicCheckout.prototype.onGetInvoiceError=function(req,e,errorCode){var errorData=req.response;!req.response&&errorCode&&(errorData={success:!1,error_type:errorCode,message:ProcessOut.Translator.translateError(errorCode)}),ProcessOut.DynamicCheckoutEventsUtils.dispatchInvoiceFetchingErrorEvent(errorData)},DynamicCheckout.prototype.onGetInvoiceSuccess=function(data){if(!data.success)return ProcessOut.DynamicCheckoutEventsUtils.dispatchInvoiceFetchingErrorEvent(data);var invoice=data.invoice;this.invoiceDetails=invoice,this.paymentConfig.paymentMethods=invoice.payment_methods,this.performMounting()},DynamicCheckout.prototype.mount=function(containerSelector){if(this.dcoContainer=document.querySelector(containerSelector),!this.dcoContainer)throw new Error("Element with this selector does not exist. You must provide a valid element selector");this.getInvoiceDetails({onFetch:ProcessOut.DynamicCheckoutEventsUtils.dispatchWidgetLoadingEvent,onSuccess:this.onGetInvoiceSuccess.bind(this),onError:this.onGetInvoiceError.bind(this)})},DynamicCheckout.prototype.performMounting=function(){var formView=new ProcessOut.DynamicCheckoutFormView(this.paymentConfig);this.loadView(formView.getViewElement()),formView.postSetup(),ProcessOut.DynamicCheckoutEventsUtils.dispatchWidgetReadyEvent()},DynamicCheckout.prototype.loadView=function(view){this.widgetWrapper&&this.dcoContainer.removeChild(this.widgetWrapper),this.widgetWrapper=this.createWidgetWrapper(),this.widgetWrapper.appendChild(view),this.dcoContainer.appendChild(this.widgetWrapper)},DynamicCheckout.prototype.createWidgetWrapper=function(){var widgetWrapper=document.createElement("div");return widgetWrapper.setAttribute("class","dynamic-checkout-widget-wrapper"),widgetWrapper},DynamicCheckout}();ProcessOut.DynamicCheckout=DynamicCheckout}(ProcessOut=ProcessOut||{}),function(ProcessOut){var DynamicCheckoutConfig=function(){function DynamicCheckoutConfig(config){this.setConfig(config)}return DynamicCheckoutConfig.prototype.getConfig=function(){return{invoiceId:this.invoiceId,projectId:this.projectId,paymentMethods:this.paymentMethods}},DynamicCheckoutConfig.prototype.setConfig=function(config){if(!this.isValidConfig(config))throw new Error("You must instantiate Dynamic Checkout with a valid config in order to use it");var invoiceId=config.invoiceId,projectId=config.projectId;this.invoiceId=invoiceId,this.projectId=projectId},DynamicCheckoutConfig.prototype.isValidConfig=function(config){return!!config.projectId&&!!config.invoiceId},DynamicCheckoutConfig}();ProcessOut.DynamicCheckoutConfig=DynamicCheckoutConfig}(ProcessOut=ProcessOut||{}),function(ProcessOut){var DynamicCheckoutFormView=function(){function DynamicCheckoutFormView(_a){var paymentMethods=_a.paymentMethods,projectId=_a.projectId,invoiceId=_a.invoiceId;this.paymentMethods=paymentMethods,this.projectId=projectId,this.invoiceId=invoiceId,this.formElement=this.createFormElement(),this.applyDynamicStyles()}return DynamicCheckoutFormView.prototype.hexToRgba=function(hex){return"rgba("+parseInt(hex.slice(2,4),16)+", "+parseInt(hex.slice(4,6),16)+", "+parseInt(hex.slice(6,8),16)+", "+parseInt(hex.slice(8,10),16)/255+")"},DynamicCheckoutFormView.prototype.applyDynamicStyles=function(){var styleElement=document.createElement("style");styleElement.innerHTML=dynamicStyles,document.head.appendChild(styleElement)},DynamicCheckoutFormView.prototype.getViewElement=function(){return this.formElement},DynamicCheckoutFormView.prototype.postSetup=function(){var _this=this;document.querySelectorAll(".pay-button[data-method-id]").forEach(function(button){button.addEventListener("click",function(event){var redirectUrl=button.getAttribute("data-redirect-url"),gatewayConfigurationId=button.getAttribute("data-method-id");redirectUrl?window.location.href=redirectUrl:_this.prepareNativeAPM(gatewayConfigurationId)})});var cardFormElement=document.getElementById("card-form"),projectId=this.projectId,client=new ProcessOut.ProcessOut(projectId),options=new ProcessOut.CardFieldOptions("");options.style={fontSize:"14px","::placeholder":{color:"#ECEFF1"}},options.requireCVC=!1,options.placeholder="",options.expiryAutoNext=!0,options.cardNumberAutoNext=!0,client.setupForm(cardFormElement,options,function(form){form.addEventListener("submit",function(e){e.preventDefault();var nameElement=document.getElementById("card-form-name");return client.tokenize(form,{name:nameElement.value||""},function(token){ProcessOut.DynamicCheckoutEventsUtils.dispatchTokenizePaymentSuccessEvent(token)},function(err){console.error("Tokenize payment error:",err),ProcessOut.DynamicCheckoutEventsUtils.dispatchTokenizePaymentErrorEvent({message:"Tokenize payment error: "+JSON.stringify(err,undefined,2)})}),!1})},function(err){console.log({err:err})});var googlePayConfigurations=this.paymentMethods.filter(function(p){return!!p.googlepay});0<googlePayConfigurations.length?googlePayConfigurations[0]:undefined},DynamicCheckoutFormView.prototype.prepareNativeAPM=function(gatewayConfigurationId){var napmContainer=document.querySelector("#dynamic-cko-container");napmContainer&&(napmContainer.innerHTML=""),new ProcessOut.ProcessOut(this.projectId).setupNativeApm({gatewayConfigurationId:gatewayConfigurationId,invoiceId:this.invoiceId}).mount("#dynamic-cko-container")},DynamicCheckoutFormView.prototype.generateFormHtml=function(){var cardPaymentHtml=this.paymentMethods.some(function(p){return"card"===p.type})?this.getCardPaymentHtml():"",_a=this.getPaymentMethodsHtml(),expressCheckoutHtml=_a.expressCheckoutHtml,directCheckoutHtml=_a.directCheckoutHtml;return'\n        <div id="dynamic-checkout-cko">\n            <div class="hosted-payment-page">\n              '+(expressCheckoutHtml?'\n        <div class="express-checkout">\n          <div class="title">Express checkout</div>\n          '+expressCheckoutHtml+"\n        </div>\n      ":"")+"\n              "+(directCheckoutHtml?'\n          <div class="direct-checkout">\n            '+directCheckoutHtml+"\n          </div>\n        ":"")+"\n              "+cardPaymentHtml+"\n            </div>\n        </div>"},DynamicCheckoutFormView.prototype.createFormElement=function(){var container=document.createElement("div");return container.innerHTML=this.generateFormHtml().trim(),container.querySelector("#dynamic-checkout-cko")},DynamicCheckoutFormView.prototype.getCardPaymentHtml=function(){return'\n        <div class="or">\n            <span>or</span>\n        </div>\n        <form action="" method="POST" id="card-form">\n          <div class="card-payment">\n              <div class="input-group">\n                  <div class="input-label">Card Number</div>\n                  <div class="input" data-processout-input="cc-number" data-processout-placeholder="0000 0000 0000 0000"></div>\n              </div>\n              <div class="input-row">\n                  <div class="input-group">\n                      <div class="input-label">Expiry Date</div>\n                      <div class="input" data-processout-input="cc-exp" data-processout-placeholder="MM/YY"></div>\n                  </div>\n                  <div class="input-group">\n                      <div class="input-label">CVC</div>\n                      <div class="input" data-processout-input="cc-cvc" data-processout-placeholder="CVC"></div>\n                  </div>\n              </div>\n              <div class="input-group">\n                  <div class="input-label">Cardholder Name</div>\n                  <input class="input" type="text" placeholder="John Smith" id="card-form-name" />\n              </div>\n          </div>\n          <button type="submit" class="cta-pay">Pay</button>\n        </form>'},DynamicCheckoutFormView.prototype.getPaymentMethodsHtml=function(){var _this=this,expressCheckoutHtml="",directCheckoutHtml="";return this.paymentMethods.forEach(function(_a){var flow=_a.flow,type=_a.type,apm=_a.apm,display=_a.display;"express"===flow?expressCheckoutHtml+=_this.getExpressCheckoutHtml(type):"apm"===type&&(directCheckoutHtml+=_this.getDirectCheckoutHtml(apm,display))}),{expressCheckoutHtml:expressCheckoutHtml,directCheckoutHtml:directCheckoutHtml}},DynamicCheckoutFormView.prototype.getExpressCheckoutHtml=function(type){switch(type){case"googlepay":case"applepay":default:return""}},DynamicCheckoutFormView.prototype.getDirectCheckoutHtml=function(apm,display){return'\n        <div class="pay-button" data-method-id="'+apm.gateway_configuration_uid+"."+apm.gateway_name+'" data-redirect-url="'+(apm.redirect_url||"")+'">\n            <div class="payment-method" style="background-color: '+this.hexToRgba(display.brand_color.dark)+'">\n                <img src="'+display.logo.dark_url.vector+'" style="margin: 0 auto; height: 40px" />\n            </div>\n        </div>'},DynamicCheckoutFormView.prototype.initializeGooglePay=function(configuration){var baseRequest={apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:configuration.allowed_auth_methods,allowedCardNetworks:configuration.allowed_card_networks},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"example",gatewayMerchantId:"exampleGatewayMerchantId"}}}]},paymentsClient=null;function getGooglePaymentsClient(){return null===paymentsClient&&(paymentsClient=new google.payments.api.PaymentsClient({environment:"TEST"})),paymentsClient}function onGooglePaymentButtonClicked(){var paymentDataRequest=__assign({},baseRequest,{transactionInfo:{countryCode:"US",currencyCode:"USD",totalPriceStatus:"FINAL",totalPrice:"1.00"}});getGooglePaymentsClient().loadPaymentData(paymentDataRequest).then(function(paymentData){!function processPayment(paymentData){console.log("Google Pay payment data:",paymentData)}(paymentData)})["catch"](function(err){console.error("Error loading payment data:",err)})}!function onGooglePayLoaded(){getGooglePaymentsClient().isReadyToPay(baseRequest).then(function(response){response.result&&!function addGooglePayButton(){var container=document.getElementById("google-pay-button-container");if(!container)return void console.error("Container element not found.");var button=getGooglePaymentsClient().createButton({onClick:onGooglePaymentButtonClicked,buttonSizeMode:"fill"});container.appendChild(button)}()})["catch"](function(err){console.error("Error checking Google Pay readiness:",err)})}()},DynamicCheckoutFormView}();ProcessOut.DynamicCheckoutFormView=DynamicCheckoutFormView}(ProcessOut=ProcessOut||{});var ProcessOut,dynamicStyles="\n* {\n  box-sizing: border-box;\n}\n\n.payment-method {\n  position: relative;\n  text-align: center;\n  background-color: rgba(255, 255, 255, 1);\n  border-radius: 4px;\n  border: 1px solid #dde0e3;\n  display: flex;\n  padding: 4px;\n  cursor: pointer;\n}\n\n.payment-method:hover {\n  border: 1px solid #7d7f81;\n}\n\n.hosted-payment-page {\n  background-color: white;\n  border-radius: 4px;\n  border: 1px solid #edeeef;\n  max-width: 320px;\n  padding: 20px;\n  margin: 0 auto;\n  margin-top: 20px;\n  margin-bottom: 200px;\n  width: 100%;\n\n  .express-checkout {\n    border: 1px solid #dde0e3;\n    gap: 8px;\n    display: flex;\n    flex-direction: column;\n    padding: 20px 10px 10px;\n    position: relative;\n    margin-bottom: 20px;\n    border-radius: 4px;\n\n    .title {\n      position: absolute;\n      top: -11px;\n      font-size: 14px;\n      left: 72px;\n      background-color: white;\n      padding: 0 10px;\n    }\n  }\n\n  .direct-checkout {\n    display: flex;\n    flex-direction: column;\n    gap: 4px;\n  }\n}\n\n.pay-button {\n  min-height: 40px;\n  border-radius: 4px;\n}\n\n.or {\n  position: relative;\n  text-align: center;\n  padding: 20px 0;\n\n  .divider {\n    height: 1px;\n    background-color: #ccd1d6;\n    width: 100%;\n    position: absolute;\n    top: 50%;\n  }\n}\n\n.card-payment {\n\n  .input-group {\n    width: 100%;\n    margin-bottom: 16px;\n  }\n\n  .input-row {\n    display: flex;\n    gap: 10px;\n    justify-content: space-between;\n  }\n\n  .input-label {\n    margin-bottom: 8px;\n    font-size: 14px;\n  }\n\n  .input {\n    height: 40px;\n    border-radius: 4px;\n    border: 1px solid #CCD1D6;\n    padding: 12px 16px;\n    box-shadow: none;\n  }\n}\n\n.cta-pay {\n  border-radius: 4px;\n  background-color: #242C38;\n  color: white;\n  width: 100%;\n  height: 40px;\n  font-size: 14px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  margin-top: 32px;\n  cursor: pointer;\n}\n\n[data-processout-input],\ninput {\n  height: 40px;\n  border-radius: 4px;\n  border: 1px solid #CCD1D6;\n  padding: 12px 16px;\n  box-shadow: none;\n  width: 100%;\n}\n:-moz-placeholder,\n::-moz-placeholder,\n::-webkit-input-placeholder,\n:-ms-input-placeholder {\n  color: #eceff1;\n  opacity: 1;\n}\n\ninput::placeholder {\n  color: #eceff1;\n  opacity: 1;\n}\n";!function(ProcessOut){var DYNAMIC_CHECKOUT_EVENTS_WIDGET_LOADING="processout_dynamic_checkout_loading",DYNAMIC_CHECKOUT_EVENTS_WIDGET_READY="processout_dynamic_checkout_ready",DYNAMIC_CHECKOUT_EVENTS_INVOICE_FETCHING_ERROR="processout_dynamic_checkout_invoice_fetching_error",DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_SUCCESS="processout_dynamic_checkout_tokenize_payment_success",DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_ERROR="processout_dynamic_checkout_tokenize_payment_error",DynamicCheckoutEventsUtils=function(){function DynamicCheckoutEventsUtils(){}return DynamicCheckoutEventsUtils.dispatchInvoiceFetchingErrorEvent=function(errorData){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_INVOICE_FETCHING_ERROR,errorData);return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.dispatchWidgetLoadingEvent=function(){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_WIDGET_LOADING);return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.dispatchWidgetReadyEvent=function(){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_WIDGET_READY);return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.dispatchTokenizePaymentSuccessEvent=function(token){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_SUCCESS,{token:token});return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.dispatchTokenizePaymentErrorEvent=function(errorData){var event=ProcessOut.EventsUtils.createEvent(DYNAMIC_CHECKOUT_EVENTS_TOKENIZE_PAYMENT_ERROR,errorData);return window.dispatchEvent(event)},DynamicCheckoutEventsUtils.createEvent=function(eventName,data){if("function"==typeof window.CustomEvent)return new CustomEvent(eventName,{bubbles:!0,detail:data});var event_2=document.createEvent("CustomEvent");return event_2.initCustomEvent(eventName,!0,!1,data),event_2},DynamicCheckoutEventsUtils}();ProcessOut.DynamicCheckoutEventsUtils=DynamicCheckoutEventsUtils}(ProcessOut=ProcessOut||{}),function(){for(var buttons=document.querySelectorAll(".processout-modal-button"),i=0;i<buttons.length;i++){!function(){var button=buttons[i],loading=!1,modal=null,preclick=function(){return loading&&(document.body.style.cursor="wait",setTimeout(function(){button.click()},500)),!1},url=button.getAttribute("href"),projectIDs=url.match(/(test\-)?proj_[a-zA-Z0-9]+/),projectID="";0<projectIDs.length&&(projectID=projectIDs[0]);var processOut=new ProcessOut.ProcessOut(projectID,"");button.onmouseover=function(){if(!loading&&(null==modal||modal.isDeleted())){var error=function(err){console.log("Could not properly load the modal"),console.log(err),window.location.href=url};loading=!0,modal=processOut.newModal({url:url,onReady:function(modal){button.onclick=function(){return modal.isDeleted()||(loading=!1,document.body.style.cursor="auto",modal.show({onError:function(modal,err){error(err)}}),button.onclick=preclick),!1}},onError:error})}},button.onclick=preclick}()}}();
